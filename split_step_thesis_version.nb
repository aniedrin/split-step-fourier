(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    358133,       9266]
NotebookOptionsPosition[    351761,       9062]
NotebookOutlinePosition[    352105,       9077]
CellTagsIndexPosition[    352062,       9074]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Code", "Title",
 CellChangeTimes->{{3.5416515938640003`*^9, 3.541651594488*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fs", "=", "1"}], ";", " ", 
  RowBox[{"ns", "=", 
   SuperscriptBox["10", "6"]}], ";", " ", 
  RowBox[{"um", "=", "1"}], ";", " ", 
  RowBox[{"nm", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "3"}]]}], ";", " ", 
  RowBox[{"mm", "=", 
   SuperscriptBox["10", "3"]}], ";", " ", 
  RowBox[{"m", "=", 
   SuperscriptBox["10", "6"]}], ";", " ", 
  RowBox[{"s", "=", 
   SuperscriptBox["10", "15"]}], ";", 
  RowBox[{"c", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<GUIKit`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell["Split-step", "Subtitle",
 CellChangeTimes->{{3.539632071602*^9, 3.53963207206*^9}, {
  3.5416515998859997`*^9, 3.541651601264*^9}}],

Cell["\<\
This split-step Fourier code starts by generating ideal Gaussian pump, \
signal, and idler pulses at the front of the crystal. Ep, Es, and Ei are the \
field amplitudes, \[Alpha] is the pump/signal angle in radians, tp, ts, and \
ti are the FWHM pulse durations, \[Delta]t is the relative timing between \
pump and signal. \[Lambda]p and \[Lambda]s specify central wavelengths for \
the pump and signal. pts is the number of points on the time/frequency grid, \
and should be a power of 2. zpts is the number of steps to propagate in z, by \
dz for each step. This code automatically calculates the phase-matched angle \
for the specified pump and signal wavelengths, and \[CapitalDelta]\[Theta] is \
the deviation in crystal angle from that phase-matched angle. deff specifies \
the effective nonlinearity to use. disp allows the spectral phase correction \
to be turned off, which is only useful for diagnostic purposes. An input of 1 \
runs normally and 0 turns it off. Ecalc allows the energy calculations to be \
turned on or off, since they can be time-consuming. 1 turns them on, and 0 \
turns them off. \
\>", "Text",
 CellChangeTimes->{{3.539017518598*^9, 3.539017528302*^9}, {3.539631994201*^9,
    3.539631994773*^9}, {3.5399793667349997`*^9, 3.53997936699*^9}, 
   3.5420440370502*^9, {3.542403904967*^9, 3.542404276042*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SplitStep", "[", 
     RowBox[{
     "Ep_", ",", "Es_", ",", "Ei_", ",", "\[Alpha]_", ",", "tp_", ",", "ts_", 
      ",", "ti_", ",", "\[Delta]t_", ",", "\[Lambda]p_", ",", "\[Lambda]s_", 
      ",", "pts_", ",", "zpts_", ",", "dz_", ",", "\[CapitalDelta]\[Theta]_", 
      ",", "deff_", ",", "disp_", ",", "Ecalc_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "FFT", ",", "InverseFFT", ",", "no", ",", "ne", ",", "ne1", ",", 
        "\[Beta]", ",", "nlsolve", ",", "Epump", ",", "Esig", ",", "Eidler", 
        ",", "epumparray", ",", "esigarray", ",", "eidlerarray", ",", 
        "epumphalf", ",", "esighalf", ",", "eidlerhalf", ",", "\[Theta]Tst", 
        ",", "\[Theta]root", ",", "\[Theta]pm", ",", "kp", ",", "ks", ",", 
        "ki", ",", "\[CapitalDelta]k", ",", "i", ",", "j", ",", "idlerE", ",",
         "sigE", ",", "pumpE", ",", "Etotal", ",", "soln", ",", "fOPA", ",", 
        "Epumparray", ",", "Esigarray", ",", "Eidlerarray", ",", "nsig", ",", 
        "nidl", ",", "npump", ",", "\[Theta]", ",", "\[Omega]", ",", "lambda",
         ",", "const"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "code", " ", "for", " ", "a", " ", "progress", " ", "bar", " ", "to", 
        " ", "appear", " ", "during", " ", "calculations"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ProgressDialog", "[", "]"}], ":=", 
        RowBox[{"GUIRun", "[", " ", "\[IndentingNewLine]", 
         RowBox[{"Widget", "[", 
          RowBox[{"\"\<Frame\>\"", ",", 
           RowBox[{"{", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"WidgetGroup", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Widget", "[", 
                  RowBox[{"\"\<Label\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<text\>\"", "\[Rule]", "\"\<Percent complete:\>\""}], 
                    "}"}], ",", 
                   RowBox[{"Name", "\[Rule]", "\"\<label\>\""}]}], "]"}], ",", 
                 RowBox[{"Widget", "[", 
                  RowBox[{"\"\<ProgressBar\>\"", ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<minimum\>\"", "\[Rule]", "0"}], ",", 
                    RowBox[{"\"\<maximum\>\"", "\[Rule]", "100"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<preferredSize\>\"", "\[Rule]", "\[IndentingNewLine]",
                     "  ", 
                    RowBox[{"Widget", "[", 
                    RowBox[{"\"\<Dimension\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<width\>\"", "\[Rule]", "300"}], ",", 
                    RowBox[{"\"\<height\>\"", "\[Rule]", "25"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], ",", 
                   RowBox[{"Name", "\[Rule]", "\"\<bar\>\""}]}], "]"}]}], " ",
                 "\[IndentingNewLine]", "  ", "}"}], ",", " ", 
               RowBox[{"WidgetLayout", " ", "\[Rule]", " ", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"\"\<Grouping\>\"", "\[Rule]", " ", "Column"}], ",",
                   " ", "\[IndentingNewLine]", 
                  RowBox[{"\"\<Border\>\"", " ", "\[Rule]", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"15", ",", "15"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"25", ",", "20"}], "}"}]}], "}"}]}]}], "}"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<location\>\"", "\[Rule]", 
              RowBox[{"Widget", "[", 
               RowBox[{"\"\<Point\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\"\<x\>\"", "\[Rule]", "400"}], ",", 
                  RowBox[{"\"\<y\>\"", "\[Rule]", "400"}]}], "}"}]}], "]"}]}],
              ",", 
             RowBox[{
             "\"\<title\>\"", "\[Rule]", "\"\<Computation Progress\>\""}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<resizable\>\"", "\[Rule]", "False"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Name", "\[Rule]", "\"\<frame\>\""}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ref", " ", "=", " ", 
        RowBox[{"ProgressDialog", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Definitions", " ", "for", " ", "FFT", " ", "and", " ", "inverse", 
          " ", "using", " ", "the", " ", "built"}], "-", 
         RowBox[{"in", " ", "transform"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FFT", "[", 
         RowBox[{"fLst_", ",", "npts_", ",", "dt1_"}], "]"}], ":=", 
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{"npts", " ", 
            SuperscriptBox["dt1", "2"]}], 
           RowBox[{"2", " ", "\[Pi]"}]]], 
         RowBox[{"RotateLeft", "[", 
          RowBox[{
           RowBox[{"Fourier", "[", 
            RowBox[{"RotateRight", "[", 
             RowBox[{"fLst", ",", 
              RowBox[{"npts", "/", "2"}]}], "]"}], "]"}], ",", 
           RowBox[{"npts", "/", "2"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"InverseFFT", "[", 
         RowBox[{"FLst_", ",", "npts_", ",", "dt1_"}], "]"}], ":=", 
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{"2", " ", "\[Pi]"}], 
           RowBox[{"npts", " ", 
            SuperscriptBox["dt1", "2"]}]]], 
         RowBox[{"RotateLeft", "[", 
          RowBox[{
           RowBox[{"InverseFourier", "[", 
            RowBox[{"RotateRight", "[", 
             RowBox[{"FLst", ",", 
              RowBox[{"npts", "/", "2"}]}], "]"}], "]"}], ",", 
           RowBox[{"npts", "/", "2"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Sellmeier", " ", "equations", " ", "for", " ", 
          RowBox[{"BBO", ".", " ", "To"}], " ", "change", " ", "the", " ", 
          "crystal", " ", "type"}], ",", " ", 
         RowBox[{
          RowBox[{"replace", " ", "these", " ", 
           RowBox[{"equations", ".", " ", "The"}], " ", "phase"}], "-", 
          RowBox[{
          "matching", " ", "type", " ", "is", " ", "determined", " ", "by", 
           " ", "the", " ", "indices", " ", "defined", " ", "for", " ", 
           "nsig"}]}], ",", " ", 
         RowBox[{"nidl", " ", "and", " ", "npump"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"no", "[", "lambda_", "]"}], "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"2.7359", "+", 
          RowBox[{"0.01878", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"lambda", "^", "2"}], "-", "0.01822"}], ")"}]}], "-", 
          RowBox[{"0.01471", " ", 
           RowBox[{"lambda", "^", "2"}]}], "+", 
          RowBox[{".0006081", " ", 
           RowBox[{"lambda", "^", "4"}]}], "-", 
          RowBox[{".0000674", " ", 
           RowBox[{"lambda", "^", "6"}]}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"ne1", "[", "lambda_", "]"}], "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"2.3753", "+", 
          RowBox[{"0.01224", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"lambda", "^", "2"}], "-", "0.01667"}], ")"}]}], "-", 
          RowBox[{"0.01627", " ", 
           RowBox[{"lambda", "^", "2"}]}], "+", 
          RowBox[{".0005716", 
           RowBox[{"lambda", "^", "4"}]}], "-", 
          RowBox[{".00006305", 
           RowBox[{"lambda", "^", "6"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ne", "[", 
         RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", " ", 
        RowBox[{"Sqrt", "[", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SuperscriptBox[
              RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], 
             SuperscriptBox[
              RowBox[{"no", "[", "\[Lambda]", "]"}], "2"]], "+", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
             SuperscriptBox[
              RowBox[{"ne1", "[", "\[Lambda]", "]"}], "2"]]}], ")"}], 
          RowBox[{"-", "1"}]], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nsig", "[", 
         RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", 
        RowBox[{"no", "[", "\[Lambda]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nidl", "[", 
         RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", 
        RowBox[{"no", "[", "\[Lambda]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"npump", "[", 
         RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", 
        RowBox[{"ne", "[", 
         RowBox[{"\[Lambda]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Initial", " ", "grid", " ", "definitions", " ", "and", " ", 
         "Gaussian", " ", "envelopes"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dt", "=", 
        RowBox[{
         FractionBox["\[Lambda]p", 
          RowBox[{"2", "c"}]], "+", ".001"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dw", "=", 
        RowBox[{"2", 
         RowBox[{"\[Pi]", "/", 
          RowBox[{"(", 
           RowBox[{"pts", "*", "dt"}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"wlist", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", " ", "dw"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"-", "pts"}], "/", "2"}], ",", 
            RowBox[{
             RowBox[{"pts", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tlist", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", " ", "dt"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"-", "pts"}], "/", "2"}], ",", 
            RowBox[{
             RowBox[{"pts", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zlist", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", " ", "dz"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "zpts"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Epump", "[", "t_", "]"}], ":=", 
        RowBox[{"Ep", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["t", "2"]}], "/", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"tp", "/", "1.66511"}], ")"}], "2"]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Esig", "[", "t_", "]"}], ":=", 
        RowBox[{"Es", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"t", "-", "\[Delta]t"}], ")"}], "2"]}], "/", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"ts", "/", "1.66511"}], ")"}], "2"]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eidler", "[", "t_", "]"}], ":=", 
        RowBox[{"Ei", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["t", "2"]}], "/", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"ti", "/", "1.66511"}], ")"}], "2"]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Omega]p", "=", 
        FractionBox[
         RowBox[{"2", "\[Pi]", " ", "c"}], "\[Lambda]p"]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Omega]s", "=", 
        FractionBox[
         RowBox[{"2", "\[Pi]", " ", "c"}], "\[Lambda]s"]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Omega]i", "=", 
        RowBox[{"\[Omega]p", "-", "\[Omega]s"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]i", "=", 
        FractionBox[
         RowBox[{"2", "\[Pi]", " ", "c"}], "\[Omega]i"]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"phase", "-", 
         RowBox[{"matching", " ", 
          RowBox[{"calculations", ".", " ", "The"}], " ", "\[CapitalDelta]k", 
          " ", "term", " ", "is", " ", "not", " ", "explicitly", " ", "used", 
          " ", "in", " ", "the", " ", "propagation", " ", "code"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[Beta]", "=", 
        RowBox[{"ArcSin", "[", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"no", "[", "\[Lambda]s", "]"}], "\[Lambda]i"}], 
           RowBox[{
            RowBox[{"no", "[", "\[Lambda]i", "]"}], "\[Lambda]s"}]], 
          RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]Tst", "=", 
        RowBox[{"\[Pi]", "/", "4"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]root", "=", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"npump", "[", 
              RowBox[{"\[Lambda]p", ",", "\[Theta]"}], "]"}], "\[Lambda]p"], 
            "-", 
            FractionBox[
             RowBox[{
              RowBox[{"nsig", "[", 
               RowBox[{"\[Lambda]s", ",", "\[Theta]"}], "]"}], 
              RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "\[Lambda]s"], "-", 
            FractionBox[
             RowBox[{
              RowBox[{"nidl", "[", 
               RowBox[{"\[Lambda]i", ",", "\[Theta]"}], "]"}], 
              RowBox[{"Cos", "[", "\[Beta]", "]"}]}], "\[Lambda]i"]}], 
           "\[Equal]", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "\[Theta]Tst"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]pm", "=", 
        RowBox[{"\[Theta]", "/.", "\[InvisibleSpace]", "\[Theta]root"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Phasematch angle: \>\"", ",", 
         RowBox[{"\[Theta]pm", "/", "Degree"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ks", "=", 
        RowBox[{
         FractionBox[
          RowBox[{"2", "\[Pi]", " ", 
           RowBox[{"nsig", "[", 
            RowBox[{"\[Lambda]s", ",", 
             RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
            "]"}]}], "\[Lambda]s"], 
         RowBox[{"Cos", "[", "\[Alpha]", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ki", "=", 
        RowBox[{
         FractionBox[
          RowBox[{"2", "\[Pi]", " ", 
           RowBox[{"nidl", "[", 
            RowBox[{"\[Lambda]i", ",", 
             RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
            "]"}]}], "\[Lambda]i"], 
         RowBox[{"Cos", "[", "\[Beta]", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"kp", "=", 
        FractionBox[
         RowBox[{"2", "\[Pi]", " ", 
          RowBox[{"npump", "[", 
           RowBox[{"\[Lambda]p", ",", 
            RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], "]"}]}],
          "\[Lambda]p"]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]k", "=", 
        RowBox[{"kp", "-", "ks", "-", "ki"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"const", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             FractionBox["\[Omega]", "c"], 
             RowBox[{"npump", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"2", " ", "\[Pi]", " ", "c"}], "\[Omega]"], ",", 
               RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
              "]"}]}], ",", "\[Omega]"}], "]"}], "/.", 
          RowBox[{"\[Omega]", "\[Rule]", " ", "\[Omega]p"}]}], "//", "N"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"RK4", " ", "nonlinearity", " ", "code"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fOPA", "[", "eIn_", "]"}], ":=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"2", "I", " ", "deff", " ", 
             SuperscriptBox["\[Omega]s", "2"]}], 
            RowBox[{"ks", " ", 
             SuperscriptBox["c", "2"]}]], 
           RowBox[{"eIn", "[", 
            RowBox[{"[", "3", "]"}], "]"}], " ", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"eIn", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{
           FractionBox[
            RowBox[{"2", "I", " ", "deff", " ", 
             SuperscriptBox["\[Omega]i", "2"]}], 
            RowBox[{"ki", " ", 
             SuperscriptBox["c", "2"]}]], 
           RowBox[{"eIn", "[", 
            RowBox[{"[", "3", "]"}], "]"}], " ", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"eIn", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{
           FractionBox[
            RowBox[{"2", " ", "I", " ", "deff", " ", 
             SuperscriptBox["\[Omega]p", "2"]}], 
            RowBox[{"kp", " ", 
             SuperscriptBox["c", "2"]}]], 
           RowBox[{"eIn", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", 
           RowBox[{"eIn", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nlsolve", "[", "eIn_", "]"}], ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"RK0", ",", "RK1", ",", "RK2", ",", "RK3", ",", "eOut"}], 
           "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"RK0", "=", 
            RowBox[{"dz", " ", 
             RowBox[{"fOPA", "[", "eIn", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"RK1", "=", 
            RowBox[{"dz", " ", 
             RowBox[{"fOPA", "[", 
              RowBox[{"eIn", "+", 
               RowBox[{"RK0", "/", "2"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"RK2", "=", 
            RowBox[{"dz", " ", 
             RowBox[{"fOPA", "[", 
              RowBox[{"eIn", "+", 
               RowBox[{"RK1", "/", "2"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"RK3", "=", 
            RowBox[{"dz", " ", 
             RowBox[{"fOPA", "[", 
              RowBox[{"eIn", "+", "RK2"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"eOut", " ", "=", 
            RowBox[{"eIn", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"RK0", "+", 
                RowBox[{"2", " ", "RK1"}], "+", 
                RowBox[{"2", " ", "RK2"}], "+", "RK3"}], ")"}], "/", 
              "6"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "eOut", "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "initialize", " ", "ideal", " ", "gaussian", " ", "fields", " ", "to",
          " ", "start"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Epumparray", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"pts", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Epumparray", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"Epump", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "pts"}], "/", "2"}], "+", "i", "-", "1"}], ")"}],
              "dt"}], "]"}], "//", "N"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Esigarray", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"pts", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Esigarray", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"Esig", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "pts"}], "/", "2"}], "+", "i", "-", "1"}], ")"}],
              "dt"}], "]"}], "//", "N"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Eidlerarray", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"pts", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Eidlerarray", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"Eidler", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "pts"}], "/", "2"}], "+", "i", "-", "1"}], ")"}],
              "dt"}], "]"}], "//", "N"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"epumparray", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"epumparray", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"FFT", "[", 
         RowBox[{
          RowBox[{"Epumparray", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"esigarray", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"esigarray", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"RotateLeft", "[", 
         RowBox[{
          RowBox[{"FFT", "[", 
           RowBox[{
            RowBox[{"Esigarray", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "pts", ",", "dt"}], "]"}], 
          ",", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eidlerarray", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eidlerarray", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"RotateLeft", "[", 
         RowBox[{
          RowBox[{"FFT", "[", 
           RowBox[{
            RowBox[{"Eidlerarray", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "pts", ",", "dt"}], "]"}], 
          ",", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"propagate", " ", 
          RowBox[{"dz", "/", "2"}], " ", "for", " ", "symmetric", " ", 
          "split"}], "-", 
         RowBox[{"step", " ", "start"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"epumphalf", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"epumparray", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", "*", "disp", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
               RowBox[{"npump", "[", 
                RowBox[{
                 FractionBox[
                  RowBox[{"2", "\[Pi]", " ", "c"}], 
                  RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["\[Omega]p", "c"]}], 
                RowBox[{"npump", "[", 
                 RowBox[{"\[Lambda]p", ",", 
                  RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                 "]"}]}], "*)"}], "-", 
              RowBox[{"const", "*", 
               RowBox[{"(", 
                RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
            RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"esighalf", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"esigarray", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", "*", "disp", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
               RowBox[{"nsig", "[", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{"2", "\[Pi]", " ", "c"}], 
                   RowBox[{"wlist", "+", "\[Omega]p"}]], 
                  RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["\[Omega]s", "c"]}], 
                RowBox[{"nsig", "[", 
                 RowBox[{"\[Lambda]s", ",", 
                  RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                 "]"}]}], "*)"}], "-", 
              RowBox[{"const", "*", 
               RowBox[{"(", 
                RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
            RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eidlerhalf", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"eidlerarray", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", "*", "disp", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
               RowBox[{"nidl", "[", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{"2", "\[Pi]", " ", "c"}], 
                   RowBox[{"wlist", "+", "\[Omega]p"}]], 
                  RowBox[{"Cos", "[", "\[Beta]", "]"}]}], ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["\[Omega]i", "c"]}], 
                RowBox[{"nidl", "[", 
                 RowBox[{"\[Lambda]i", ",", 
                  RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                 "]"}]}], "*)"}], "-", 
              RowBox[{"const", "*", 
               RowBox[{"(", 
                RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
            RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Epumparray", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"InverseFFT", "[", 
         RowBox[{"epumphalf", ",", "pts", ",", "dt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Esigarray", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"InverseFFT", "[", 
         RowBox[{
          RowBox[{"RotateRight", "[", 
           RowBox[{"esighalf", ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
             "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eidlerarray", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"InverseFFT", "[", 
         RowBox[{
          RowBox[{"RotateRight", "[", 
           RowBox[{"eidlerhalf", ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
             "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"loop", " ", "nonlinearity"}], ",", " ", "xform", ",", " ", 
         "dispersion", ",", " ", 
         RowBox[{"inverse", " ", "xform"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", "zpts"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"soln", "=", 
           RowBox[{"nlsolve", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Esigarray", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"Eidlerarray", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"Epumparray", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Esigarray", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{"soln", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Eidlerarray", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{"soln", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Epumparray", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{"soln", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"epumparray", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", 
           RowBox[{"FFT", "[", 
            RowBox[{
             RowBox[{"Epumparray", "[", 
              RowBox[{"[", 
               RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}],
             "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"esigarray", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", 
           RowBox[{"RotateLeft", "[", 
            RowBox[{
             RowBox[{"FFT", "[", 
              RowBox[{
               RowBox[{"Esigarray", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", 
               "dt"}], "]"}], ",", 
             RowBox[{"Round", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"eidlerarray", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", 
           RowBox[{"RotateLeft", "[", 
            RowBox[{
             RowBox[{"FFT", "[", 
              RowBox[{
               RowBox[{"Eidlerarray", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", 
               "dt"}], "]"}], ",", 
             RowBox[{"Round", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"epumparray", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"epumparray", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", "*", "disp", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
                  RowBox[{"npump", "[", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"2", "\[Pi]", " ", "c"}], 
                    RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                    RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                   "]"}]}], 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"-", 
                    FractionBox["\[Omega]p", "c"]}], 
                   RowBox[{"npump", "[", 
                    RowBox[{"\[Lambda]p", ",", 
                    RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                    "]"}]}], "*)"}], "-", 
                 RowBox[{"const", "*", 
                  RowBox[{"(", 
                   RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
               "dz"}], "]"}]}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"esigarray", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"esigarray", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", "*", "disp", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
                  RowBox[{"nsig", "[", 
                   RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"2", "\[Pi]", " ", "c"}], 
                    RowBox[{"wlist", "+", "\[Omega]p"}]], 
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
                    RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                   "]"}]}], 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"-", 
                    FractionBox["\[Omega]s", "c"]}], 
                   RowBox[{"npump", "[", 
                    RowBox[{"\[Lambda]p", ",", 
                    RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                    "]"}]}], "*)"}], "-", 
                 RowBox[{"const", "*", 
                  RowBox[{"(", 
                   RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
               "dz"}], "]"}]}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"eidlerarray", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"eidlerarray", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", "*", "disp", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
                  RowBox[{"nidl", "[", 
                   RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"2", "\[Pi]", " ", "c"}], 
                    RowBox[{"wlist", "+", "\[Omega]p"}]], 
                    RowBox[{"Cos", "[", "\[Beta]", "]"}]}], ",", 
                    RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                   "]"}]}], 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"-", 
                    FractionBox["\[Omega]i", "c"]}], 
                   RowBox[{"npump", "[", 
                    RowBox[{"\[Lambda]p", ",", 
                    RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                    "]"}]}], "*)"}], "-", 
                 RowBox[{"const", "*", 
                  RowBox[{"(", 
                   RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
               "dz"}], "]"}]}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Epumparray", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{"InverseFFT", "[", 
            RowBox[{
             RowBox[{"epumparray", "[", 
              RowBox[{"[", 
               RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}],
             "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Esigarray", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{"InverseFFT", "[", 
            RowBox[{
             RowBox[{"RotateRight", "[", 
              RowBox[{
               RowBox[{"esigarray", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", 
               RowBox[{"Round", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}],
                 "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Eidlerarray", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{"InverseFFT", "[", 
            RowBox[{
             RowBox[{"RotateRight", "[", 
              RowBox[{
               RowBox[{"eidlerarray", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", 
               RowBox[{"Round", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}],
                 "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"ref", " ", "@", " ", 
           RowBox[{"SetPropertyValue", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
             " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "/", "zpts"}], ")"}], "100"}]}], "]"}]}], ";"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ReleaseGUIObject", "[", "ref", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"full", " ", "step", " ", "dz", " ", "in", " ", "time"}], 
         ",", " ", 
         RowBox[{
         "half", " ", "step", " ", "in", " ", "\[Omega]", " ", "to", " ", 
          "complete", " ", "symmetric", " ", "propagation"}]}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"soln", "=", 
        RowBox[{"nlsolve", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Esigarray", "[", 
            RowBox[{"[", "zpts", "]"}], "]"}], ",", 
           RowBox[{"Eidlerarray", "[", 
            RowBox[{"[", "zpts", "]"}], "]"}], ",", 
           RowBox[{"Epumparray", "[", 
            RowBox[{"[", "zpts", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Esigarray", "[", 
         RowBox[{"[", 
          RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{"soln", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eidlerarray", "[", 
         RowBox[{"[", 
          RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{"soln", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Epumparray", "[", 
         RowBox[{"[", 
          RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{"soln", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"epumparray", "[", 
         RowBox[{"[", "zpts", "]"}], "]"}], "=", 
        RowBox[{"FFT", "[", 
         RowBox[{
          RowBox[{"Epumparray", "[", 
           RowBox[{"[", 
            RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"esigarray", "[", 
         RowBox[{"[", "zpts", "]"}], "]"}], "=", 
        RowBox[{"RotateLeft", "[", 
         RowBox[{
          RowBox[{"FFT", "[", 
           RowBox[{
            RowBox[{"Esigarray", "[", 
             RowBox[{"[", 
              RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", "pts", ",", 
            "dt"}], "]"}], ",", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eidlerarray", "[", 
         RowBox[{"[", "zpts", "]"}], "]"}], "=", 
        RowBox[{"RotateLeft", "[", 
         RowBox[{
          RowBox[{"FFT", "[", 
           RowBox[{
            RowBox[{"Eidlerarray", "[", 
             RowBox[{"[", 
              RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", "pts", ",", 
            "dt"}], "]"}], ",", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"epumparray", "[", 
         RowBox[{"[", 
          RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"epumparray", "[", 
           RowBox[{"[", "zpts", "]"}], "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", "*", "disp", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
               RowBox[{"npump", "[", 
                RowBox[{
                 FractionBox[
                  RowBox[{"2", "\[Pi]", " ", "c"}], 
                  RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["\[Omega]p", "c"]}], 
                RowBox[{"npump", "[", 
                 RowBox[{"\[Lambda]p", ",", 
                  RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                 "]"}]}], "*)"}], "-", 
              RowBox[{"const", "*", 
               RowBox[{"(", 
                RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
            RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"esigarray", "[", 
         RowBox[{"[", 
          RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"esigarray", "[", 
           RowBox[{"[", "zpts", "]"}], "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", "*", "disp", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
               RowBox[{"nsig", "[", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{"2", "\[Pi]", " ", "c"}], 
                   RowBox[{"wlist", "+", "\[Omega]p"}]], 
                  RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["\[Omega]s", "c"]}], 
                RowBox[{"nsig", "[", 
                 RowBox[{"\[Lambda]s", ",", 
                  RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                 "]"}]}], "*)"}], "-", 
              RowBox[{"const", "*", 
               RowBox[{"(", 
                RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
            RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eidlerarray", "[", 
         RowBox[{"[", 
          RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"eidlerarray", "[", 
           RowBox[{"[", "zpts", "]"}], "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", "*", "disp", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
               RowBox[{"nidl", "[", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{"2", "\[Pi]", " ", "c"}], 
                   RowBox[{"wlist", "+", "\[Omega]p"}]], 
                  RowBox[{"Cos", "[", "\[Beta]", "]"}]}], ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["\[Omega]i", "c"]}], 
                RowBox[{"nidl", "[", 
                 RowBox[{"\[Lambda]i", ",", 
                  RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                 "]"}]}], "*)"}], "-", 
              RowBox[{"const", "*", 
               RowBox[{"(", 
                RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
            RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Epumparray", "[", 
         RowBox[{"[", 
          RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{"InverseFFT", "[", 
         RowBox[{
          RowBox[{"epumparray", "[", 
           RowBox[{"[", 
            RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Esigarray", "[", 
         RowBox[{"[", 
          RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{"InverseFFT", "[", 
         RowBox[{
          RowBox[{"RotateRight", "[", 
           RowBox[{
            RowBox[{"esigarray", "[", 
             RowBox[{"[", 
              RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
             "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eidlerarray", "[", 
         RowBox[{"[", 
          RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{"InverseFFT", "[", 
         RowBox[{
          RowBox[{"RotateRight", "[", 
           RowBox[{
            RowBox[{"eidlerarray", "[", 
             RowBox[{"[", 
              RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
             "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Ecalc", "==", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Energy", " ", "calculations"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ref2", " ", "=", " ", 
           RowBox[{"ProgressDialog", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"idlerE", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"Abs", "[", 
                  RowBox[{"Eidlerarray", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "2"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "pts"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"zpts", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ref2", " ", "@", " ", 
           RowBox[{"SetPropertyValue", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
             " ", "33"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"sigE", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"Abs", "[", 
                  RowBox[{"Esigarray", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "2"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "pts"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"zpts", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ref2", " ", "@", " ", 
           RowBox[{"SetPropertyValue", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
             " ", "66"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pumpE", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"Abs", "[", 
                  RowBox[{"Epumparray", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "2"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "pts"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"zpts", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ref2", " ", "@", " ", 
           RowBox[{"SetPropertyValue", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
             " ", "100"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Etotal", "=", 
           RowBox[{"pumpE", "+", "sigE", "+", "idlerE"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ReleaseGUIObject", "[", "ref2", "]"}], ";"}]}], "]"}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"final", " ", "output", " ", "array"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
         "Epumparray", ",", "Esigarray", ",", "Eidlerarray", ",", 
          "epumparray", ",", "esigarray", ",", "eidlerarray", ",", "pumpE", 
          ",", "sigE", ",", "idlerE", ",", "Etotal", ",", "\[Theta]pm", ",", 
          "\[Beta]", ",", "wlist", ",", "tlist"}], "}"}], "]"}], ";"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"outputs", " ", "raw", " ", "pump"}], ",", " ", 
    RowBox[{
     RowBox[{
     "signal", " ", "and", " ", "idler", " ", "lists", " ", "on", " ", "the", 
      " ", "time", " ", "grid", " ", 
      RowBox[{"(", "E", ")"}], " ", "and", " ", "frequency", " ", "grid", " ", 
      RowBox[{
       RowBox[{"(", "e", ")"}], ".", " ", "Use"}], " ", "tlist", " ", "and", 
      " ", "wlist", " ", "to", " ", "get", " ", "the", " ", "corresponding", 
      " ", "t", " ", "and", " ", "\[Omega]", " ", "values", " ", "for", " ", 
      "each", " ", 
      RowBox[{"point", ".", " ", "Slots"}], " ", "7"}], "-", 
     RowBox[{"10", " ", "are", " ", "the", " ", "pump"}]}], ",", " ", 
    RowBox[{
    "sig", " ", "and", " ", "idler", " ", "energies", " ", "vs", " ", 
     "position"}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "their", " ", 
      RowBox[{"total", ".", " ", "\[Theta]pm"}], " ", "is", " ", "the", " ", 
      "calcuated", " ", "phase"}], "-", 
     RowBox[{"matching", " ", "angle"}]}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "\[Beta]", " ", "is", " ", "the", " ", "phase"}], 
     "-", 
     RowBox[{
     "matched", " ", "idler", " ", "angle", " ", "for", " ", "the", " ", 
      "specified", " ", "wavelengths", " ", "and", " ", 
      RowBox[{"\[Alpha]", "."}]}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5390173849519997`*^9, 3.539017627262*^9}, {
   3.539017675692*^9, 3.5390177207349997`*^9}, {3.539017777502*^9, 
   3.539018225479*^9}, {3.5390184266800003`*^9, 3.539018440459*^9}, {
   3.539018494116*^9, 3.539018533968*^9}, {3.5390185691540003`*^9, 
   3.539018570051*^9}, {3.539018671396*^9, 3.539018681781*^9}, {
   3.5390187287460003`*^9, 3.539018729468*^9}, {3.539018772663*^9, 
   3.5390188267279997`*^9}, {3.539018860984*^9, 3.539019010617*^9}, {
   3.539019043828*^9, 3.539019057442*^9}, 3.53901909226*^9, {3.53901920275*^9,
    3.539019211914*^9}, {3.5390193136099997`*^9, 3.539019380429*^9}, 
   3.539019556479*^9, {3.539019668578*^9, 3.539019671749*^9}, {
   3.539020148837*^9, 3.539020191432*^9}, {3.53902049519*^9, 
   3.5390205688900003`*^9}, {3.5390206724049997`*^9, 3.539020784649*^9}, {
   3.53902083462*^9, 3.539020836844*^9}, {3.5390210263199997`*^9, 
   3.5390210388780003`*^9}, {3.539021084343*^9, 3.5390211242939997`*^9}, 
   3.5390213293190002`*^9, {3.539021560599*^9, 3.5390215610699997`*^9}, {
   3.53902167944*^9, 3.539021686682*^9}, {3.539021726674*^9, 
   3.539021731374*^9}, {3.539021761604*^9, 3.539021761909*^9}, {
   3.539022509185*^9, 3.539022664807*^9}, {3.539022747376*^9, 
   3.539022773039*^9}, {3.53902344451*^9, 3.5390235217530003`*^9}, {
   3.539023566342*^9, 3.539023573906*^9}, {3.5390236206619997`*^9, 
   3.539023748288*^9}, {3.5390240066809998`*^9, 3.539024010994*^9}, {
   3.5390241826070004`*^9, 3.539024226988*^9}, {3.539024380962*^9, 
   3.5390244770620003`*^9}, {3.539024559731*^9, 3.5390246414639997`*^9}, {
   3.539024730867*^9, 3.539024733743*^9}, {3.539024860975*^9, 
   3.539024867395*^9}, {3.5390249329300003`*^9, 3.53902494346*^9}, {
   3.539025031138*^9, 3.539025077644*^9}, {3.5390252805369997`*^9, 
   3.539025304049*^9}, {3.539026608009*^9, 3.539026618932*^9}, {
   3.5390267077130003`*^9, 3.539026707847*^9}, {3.539026791293*^9, 
   3.539026795218*^9}, {3.539026885795*^9, 3.539026889449*^9}, {
   3.539027010141*^9, 3.5390270301140003`*^9}, {3.539027061249*^9, 
   3.53902707362*^9}, {3.5390288324516*^9, 3.5390289080246*^9}, {
   3.5390293412686*^9, 3.5390293962595997`*^9}, {3.5390296001966*^9, 
   3.5390296170866003`*^9}, {3.539100045943*^9, 3.539100061425*^9}, {
   3.539100377553*^9, 3.539100392284*^9}, {3.539100567882*^9, 
   3.539100590968*^9}, {3.539100630365*^9, 3.539100631355*^9}, {
   3.5391006638059998`*^9, 3.539100683877*^9}, {3.5391010182019997`*^9, 
   3.539101019825*^9}, {3.539101310021*^9, 3.539101382211*^9}, {
   3.5391015271689997`*^9, 3.539101543988*^9}, {3.5391015740950003`*^9, 
   3.539101574395*^9}, {3.539101835815*^9, 3.539101837118*^9}, 
   3.539101871414*^9, {3.5391019298970003`*^9, 3.5391019330629997`*^9}, {
   3.539101984509*^9, 3.539101988274*^9}, {3.539102035926*^9, 
   3.539102057115*^9}, {3.539102555657*^9, 3.53910255871*^9}, {
   3.539102727336*^9, 3.5391027320299997`*^9}, {3.5391035270897846`*^9, 
   3.539103529726185*^9}, {3.5391035754029846`*^9, 3.539103593920185*^9}, {
   3.5391036934335847`*^9, 3.5391037366143847`*^9}, {3.539103809139785*^9, 
   3.5391038750185847`*^9}, {3.5391039570901847`*^9, 
   3.5391040087885847`*^9}, {3.539363341723*^9, 3.539363343324*^9}, {
   3.5393633920076*^9, 3.5393633992506*^9}, {3.5393634682998*^9, 
   3.5393634853817997`*^9}, {3.5393635459566*^9, 3.5393635905414*^9}, {
   3.5393636453442*^9, 3.5393636741106*^9}, {3.5393637109734*^9, 
   3.5393637816258*^9}, {3.5393638562874002`*^9, 3.5393638751946*^9}, {
   3.5393639346940002`*^9, 3.5393639402476*^9}, 3.5393641939192*^9, {
   3.5393644732693996`*^9, 3.5393644931594*^9}, {3.5393648034902*^9, 
   3.5393648183882*^9}, {3.5393648591198*^9, 3.5393648758585997`*^9}, {
   3.5393651303938*^9, 3.5393651504398003`*^9}, {3.5393652167866*^9, 
   3.539365228939*^9}, {3.5393652631654*^9, 3.5393652676738*^9}, {
   3.5393653598854*^9, 3.5393653618042*^9}, {3.5393654668389997`*^9, 
   3.5393654673382*^9}, {3.5393655014709997`*^9, 3.5393655060573997`*^9}, 
   3.5393657452209997`*^9, 3.5393659209726*^9, {3.5393660254634*^9, 
   3.5393660378654003`*^9}, 3.5393661030422*^9, {3.5393665374398003`*^9, 
   3.5393665604653997`*^9}, {3.5393673424934*^9, 3.5393673515102*^9}, {
   3.5393674493444*^9, 3.5393674521991997`*^9}, {3.5393675006684*^9, 
   3.5393675029304*^9}, {3.5393675832860003`*^9, 3.5393675859692*^9}, {
   3.5393679390598*^9, 3.5393679528970003`*^9}, {3.5393708721633997`*^9, 
   3.539370881773*^9}, {3.539371245449*^9, 3.5393712932942*^9}, {
   3.5393717777844*^9, 3.5393717860212*^9}, {3.5393732266205997`*^9, 
   3.5393732511126003`*^9}, {3.5395357113438*^9, 3.5395357368342*^9}, {
   3.5395358937390003`*^9, 3.5395359350322*^9}, {3.5395408243668003`*^9, 
   3.5395408714476*^9}, {3.5395410260748*^9, 3.5395411111104*^9}, {
   3.539541330384*^9, 3.539541337014*^9}, {3.5395416530242*^9, 
   3.5395416573922*^9}, {3.5395417107286*^9, 3.5395417163134003`*^9}, {
   3.5395420566303997`*^9, 3.5395420639156*^9}, {3.5395421672888002`*^9, 
   3.539542170986*^9}, {3.5395457901744003`*^9, 3.5395457989104*^9}, {
   3.539546761769*^9, 3.5395467843733997`*^9}, {3.5395492457832003`*^9, 
   3.5395493881956*^9}, 3.539631992248*^9, {3.539976930476*^9, 
   3.539976930685*^9}, {3.5405690128252*^9, 3.5405690155572*^9}, 
   3.5405698616092*^9, {3.5405903620222*^9, 3.5405903827858*^9}, {
   3.540749244384*^9, 3.540749276741*^9}, {3.5416556998450003`*^9, 
   3.541655705425*^9}, {3.542404280196*^9, 3.542404531344*^9}, {
   3.542404619457*^9, 3.54240481059*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Split-step \[Theta]", "Subtitle",
 CellChangeTimes->{{3.541690854951*^9, 3.541690859115*^9}}],

Cell["\<\
SplitStep\[Theta] is a slightly modified version of splitstep, where now the \
\[Theta]pm variable replaces \[CapitalDelta]\[Theta], allowing the absolute \
crystal angle (in radians) to be defined instead of using the automatically \
calculated one. The routine still prints the ideal phase-matching angle for \
reference, but uses the one specified in the input. \
\>", "Text",
 CellChangeTimes->{{3.5424049239560003`*^9, 3.542405036227*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SplitStep\[Theta]", "[", 
    RowBox[{
    "Ep_", ",", "Es_", ",", "Ei_", ",", "\[Alpha]_", ",", "tp_", ",", "ts_", 
     ",", "ti_", ",", "\[Delta]t_", ",", "\[Lambda]p_", ",", "\[Lambda]s_", 
     ",", "pts_", ",", "zpts_", ",", "dz_", ",", "\[Theta]pm_", ",", "deff_", 
     ",", "disp_", ",", "Ecalc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "FFT", ",", "InverseFFT", ",", "no", ",", "ne", ",", "ne1", ",", 
       "\[Beta]", ",", "nlsolve", ",", "\[Lambda]i", ",", "Epump", ",", 
       "Esig", ",", "Eidler", ",", "epumparray", ",", "esigarray", ",", 
       "eidlerarray", ",", "epumphalf", ",", "esighalf", ",", "eidlerhalf", 
       ",", "\[Theta]Tst", ",", "\[Theta]root", ",", "kp", ",", "ks", ",", 
       "ki", ",", "\[CapitalDelta]k", ",", "i", ",", "j", ",", "idlerE", ",", 
       "sigE", ",", "pumpE", ",", "Etotal", ",", "soln", ",", "fOPA", ",", 
       "Epumparray", ",", "Esigarray", ",", "Eidlerarray", ",", "nsig", ",", 
       "nidl", ",", "npump", ",", "\[Theta]", ",", "\[Omega]", ",", "lambda", 
       ",", "const", ",", "\[Theta]i", ",", "\[CapitalDelta]\[Theta]"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Needs", "[", "\"\<GUIKit`\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ProgressDialog", "[", "]"}], ":=", 
       RowBox[{"GUIRun", "[", " ", "\[IndentingNewLine]", 
        RowBox[{"Widget", "[", 
         RowBox[{"\"\<Frame\>\"", ",", 
          RowBox[{"{", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"WidgetGroup", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Widget", "[", 
                 RowBox[{"\"\<Label\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<text\>\"", "\[Rule]", "\"\<Percent complete:\>\""}], 
                   "}"}], ",", 
                  RowBox[{"Name", "\[Rule]", "\"\<label\>\""}]}], "]"}], ",", 
                RowBox[{"Widget", "[", 
                 RowBox[{"\"\<ProgressBar\>\"", ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"\<minimum\>\"", "\[Rule]", "0"}], ",", 
                    RowBox[{"\"\<maximum\>\"", "\[Rule]", "100"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<preferredSize\>\"", "\[Rule]", "\[IndentingNewLine]",
                     "  ", 
                    RowBox[{"Widget", "[", 
                    RowBox[{"\"\<Dimension\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<width\>\"", "\[Rule]", "300"}], ",", 
                    RowBox[{"\"\<height\>\"", "\[Rule]", "25"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], ",", 
                  RowBox[{"Name", "\[Rule]", "\"\<bar\>\""}]}], "]"}]}], " ", 
               "\[IndentingNewLine]", "  ", "}"}], ",", " ", 
              RowBox[{"WidgetLayout", " ", "\[Rule]", " ", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<Grouping\>\"", "\[Rule]", " ", "Column"}], ",", 
                 " ", "\[IndentingNewLine]", 
                 RowBox[{"\"\<Border\>\"", " ", "\[Rule]", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"15", ",", "15"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"25", ",", "20"}], "}"}]}], "}"}]}]}], "}"}]}]}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<location\>\"", "\[Rule]", 
             RowBox[{"Widget", "[", 
              RowBox[{"\"\<Point\>\"", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<x\>\"", "\[Rule]", "400"}], ",", 
                 RowBox[{"\"\<y\>\"", "\[Rule]", "400"}]}], "}"}]}], "]"}]}], 
            ",", 
            RowBox[{
            "\"\<title\>\"", "\[Rule]", "\"\<Computation Progress\>\""}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"\"\<resizable\>\"", "\[Rule]", "False"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Name", "\[Rule]", "\"\<frame\>\""}]}], "]"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ref", " ", "=", " ", 
       RowBox[{"ProgressDialog", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FFT", "[", 
        RowBox[{"fLst_", ",", "npts_", ",", "dt1_"}], "]"}], ":=", 
       RowBox[{
        SqrtBox[
         FractionBox[
          RowBox[{"npts", " ", 
           SuperscriptBox["dt1", "2"]}], 
          RowBox[{"2", " ", "\[Pi]"}]]], 
        RowBox[{"RotateLeft", "[", 
         RowBox[{
          RowBox[{"Fourier", "[", 
           RowBox[{"RotateRight", "[", 
            RowBox[{"fLst", ",", 
             RowBox[{"npts", "/", "2"}]}], "]"}], "]"}], ",", 
          RowBox[{"npts", "/", "2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"InverseFFT", "[", 
        RowBox[{"FLst_", ",", "npts_", ",", "dt1_"}], "]"}], ":=", 
       RowBox[{
        SqrtBox[
         FractionBox[
          RowBox[{"2", " ", "\[Pi]"}], 
          RowBox[{"npts", " ", 
           SuperscriptBox["dt1", "2"]}]]], 
        RowBox[{"RotateLeft", "[", 
         RowBox[{
          RowBox[{"InverseFourier", "[", 
           RowBox[{"RotateRight", "[", 
            RowBox[{"FLst", ",", 
             RowBox[{"npts", "/", "2"}]}], "]"}], "]"}], ",", 
          RowBox[{"npts", "/", "2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"no", "[", "lambda_", "]"}], "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2.7359", "+", 
         RowBox[{"0.01878", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lambda", "^", "2"}], "-", "0.01822"}], ")"}]}], "-", 
         RowBox[{"0.01471", " ", 
          RowBox[{"lambda", "^", "2"}]}], "+", 
         RowBox[{".0006081", " ", 
          RowBox[{"lambda", "^", "4"}]}], "-", 
         RowBox[{".0000674", " ", 
          RowBox[{"lambda", "^", "6"}]}]}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"ne1", "[", "lambda_", "]"}], "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2.3753", "+", 
         RowBox[{"0.01224", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lambda", "^", "2"}], "-", "0.01667"}], ")"}]}], "-", 
         RowBox[{"0.01627", " ", 
          RowBox[{"lambda", "^", "2"}]}], "+", 
         RowBox[{".0005716", 
          RowBox[{"lambda", "^", "4"}]}], "-", 
         RowBox[{".00006305", 
          RowBox[{"lambda", "^", "6"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ne", "[", 
        RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", " ", 
       RowBox[{"Sqrt", "[", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], 
            SuperscriptBox[
             RowBox[{"no", "[", "\[Lambda]", "]"}], "2"]], "+", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
            SuperscriptBox[
             RowBox[{"ne1", "[", "\[Lambda]", "]"}], "2"]]}], ")"}], 
         RowBox[{"-", "1"}]], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nsig", "[", 
        RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", 
       RowBox[{"no", "[", "\[Lambda]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nidl", "[", 
        RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", 
       RowBox[{"no", "[", "\[Lambda]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"npump", "[", 
        RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", 
       RowBox[{"ne", "[", 
        RowBox[{"\[Lambda]", ",", "\[Theta]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dt", "=", 
       RowBox[{
        FractionBox["\[Lambda]p", 
         RowBox[{"2", "c"}]], "+", ".001"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dw", "=", 
       RowBox[{"2", 
        RowBox[{"\[Pi]", "/", 
         RowBox[{"(", 
          RowBox[{"pts", "*", "dt"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wlist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", " ", "dw"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"-", "pts"}], "/", "2"}], ",", 
           RowBox[{
            RowBox[{"pts", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tlist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", " ", "dt"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"-", "pts"}], "/", "2"}], ",", 
           RowBox[{
            RowBox[{"pts", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zlist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", " ", "dz"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "zpts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Epump", "[", "t_", "]"}], ":=", 
       RowBox[{"Ep", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["t", "2"]}], "/", 
          SuperscriptBox["tp", "2"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Esig", "[", "t_", "]"}], ":=", 
       RowBox[{"Es", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"t", "-", "\[Delta]t"}], ")"}], "2"]}], "/", 
          SuperscriptBox["ts", "2"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eidler", "[", "t_", "]"}], ":=", 
       RowBox[{"Ei", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["t", "2"]}], "/", 
          SuperscriptBox["ti", "2"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]p", "=", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "c"}], "\[Lambda]p"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Omega]s", "=", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "c"}], "\[Lambda]s"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Omega]i", "=", 
       RowBox[{"\[Omega]p", "-", "\[Omega]s"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]i", "=", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "c"}], "\[Omega]i"]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"phase", "-", 
        RowBox[{"matching", " ", "calculations"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"ArcSin", "[", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"no", "[", "\[Lambda]s", "]"}], "\[Lambda]i"}], 
          RowBox[{
           RowBox[{"no", "[", "\[Lambda]i", "]"}], "\[Lambda]s"}]], 
         RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]Tst", "=", 
       RowBox[{"\[Pi]", "/", "4"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]root", "=", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"npump", "[", 
             RowBox[{"\[Lambda]p", ",", "\[Theta]"}], "]"}], "\[Lambda]p"], 
           "-", 
           FractionBox[
            RowBox[{
             RowBox[{"nsig", "[", 
              RowBox[{"\[Lambda]s", ",", "\[Theta]"}], "]"}], 
             RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "\[Lambda]s"], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"nidl", "[", 
              RowBox[{"\[Lambda]i", ",", "\[Theta]"}], "]"}], 
             RowBox[{"Cos", "[", "\[Beta]", "]"}]}], "\[Lambda]i"]}], 
          "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "\[Theta]Tst"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]i", "=", 
       RowBox[{"\[Theta]", "/.", "\[InvisibleSpace]", "\[Theta]root"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]\[Theta]", "=", "0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Phasematch angle: \>\"", ",", 
        RowBox[{"\[Theta]i", "/", "Degree"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ks", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"2", "\[Pi]", " ", 
          RowBox[{"nsig", "[", 
           RowBox[{"\[Lambda]s", ",", 
            RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], "]"}]}],
          "\[Lambda]s"], 
        RowBox[{"Cos", "[", "\[Alpha]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ki", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"2", "\[Pi]", " ", 
          RowBox[{"nidl", "[", 
           RowBox[{"\[Lambda]i", ",", 
            RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], "]"}]}],
          "\[Lambda]i"], 
        RowBox[{"Cos", "[", "\[Beta]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kp", "=", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", 
         RowBox[{"npump", "[", 
          RowBox[{"\[Lambda]p", ",", 
           RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], "]"}]}], 
        "\[Lambda]p"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]k", "=", 
       RowBox[{"kp", "-", "ks", "-", "ki"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"const", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            FractionBox["\[Omega]", "c"], 
            RowBox[{"npump", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"2", " ", "\[Pi]", " ", "c"}], "\[Omega]"], ",", 
              RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
             "]"}]}], ",", "\[Omega]"}], "]"}], "/.", 
         RowBox[{"\[Omega]", "\[Rule]", " ", "\[Omega]p"}]}], "//", "N"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"RK4", " ", "nonlinearity", " ", "code"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fOPA", "[", "eIn_", "]"}], ":=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"2", "I", " ", "deff", " ", 
            SuperscriptBox["\[Omega]s", "2"]}], 
           RowBox[{"ks", " ", 
            SuperscriptBox["c", "2"]}]], 
          RowBox[{"eIn", "[", 
           RowBox[{"[", "3", "]"}], "]"}], " ", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"eIn", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"2", "I", " ", "deff", " ", 
            SuperscriptBox["\[Omega]i", "2"]}], 
           RowBox[{"ki", " ", 
            SuperscriptBox["c", "2"]}]], 
          RowBox[{"eIn", "[", 
           RowBox[{"[", "3", "]"}], "]"}], " ", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"eIn", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"2", " ", "I", " ", "deff", " ", 
            SuperscriptBox["\[Omega]p", "2"]}], 
           RowBox[{"kp", " ", 
            SuperscriptBox["c", "2"]}]], 
          RowBox[{"eIn", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", 
          RowBox[{"eIn", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nlsolve", "[", "eIn_", "]"}], ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"RK0", ",", "RK1", ",", "RK2", ",", "RK3", ",", "eOut"}], 
          "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RK0", "=", 
           RowBox[{"dz", " ", 
            RowBox[{"fOPA", "[", "eIn", "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"RK1", "=", 
           RowBox[{"dz", " ", 
            RowBox[{"fOPA", "[", 
             RowBox[{"eIn", "+", 
              RowBox[{"RK0", "/", "2"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"RK2", "=", 
           RowBox[{"dz", " ", 
            RowBox[{"fOPA", "[", 
             RowBox[{"eIn", "+", 
              RowBox[{"RK1", "/", "2"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"RK3", "=", 
           RowBox[{"dz", " ", 
            RowBox[{"fOPA", "[", 
             RowBox[{"eIn", "+", "RK2"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eOut", " ", "=", 
           RowBox[{"eIn", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"RK0", "+", 
               RowBox[{"2", " ", "RK1"}], "+", 
               RowBox[{"2", " ", "RK2"}], "+", "RK3"}], ")"}], "/", "6"}]}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "eOut", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "initialize", " ", "ideal", " ", "gaussian", " ", "fields", " ", "to", 
        " ", "start"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Epumparray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", 
         RowBox[{"pts", "+", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Epumparray", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Epump", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "pts"}], "/", "2"}], "+", "i", "-", "1"}], ")"}], 
            "dt"}], "]"}], "//", "N"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Esigarray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", 
         RowBox[{"pts", "+", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Esigarray", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Esig", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "pts"}], "/", "2"}], "+", "i", "-", "1"}], ")"}], 
            "dt"}], "]"}], "//", "N"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Eidlerarray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", 
         RowBox[{"pts", "+", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Eidlerarray", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Eidler", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "pts"}], "/", "2"}], "+", "i", "-", "1"}], ")"}], 
            "dt"}], "]"}], "//", "N"}]}]}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"epumparray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"epumparray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"FFT", "[", 
        RowBox[{
         RowBox[{"Epumparray", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"esigarray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"esigarray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"RotateLeft", "[", 
        RowBox[{
         RowBox[{"FFT", "[", 
          RowBox[{
           RowBox[{"Esigarray", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "pts", ",", "dt"}], "]"}], 
         ",", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eidlerarray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eidlerarray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"RotateLeft", "[", 
        RowBox[{
         RowBox[{"FFT", "[", 
          RowBox[{
           RowBox[{"Eidlerarray", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "pts", ",", "dt"}], "]"}], 
         ",", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"propagate", " ", 
         RowBox[{"dz", "/", "2"}], " ", "for", " ", "symmetric", " ", 
         "split"}], "-", 
        RowBox[{"step", " ", "start"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"epumphalf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"epumparray", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"npump", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{"2", "\[Pi]", " ", "c"}], 
                 RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]p", "c"]}], 
               RowBox[{"npump", "[", 
                RowBox[{"\[Lambda]p", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"esighalf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"esigarray", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"nsig", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{"2", "\[Pi]", " ", "c"}], 
                 RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]s", "c"]}], 
               RowBox[{"nsig", "[", 
                RowBox[{"\[Lambda]s", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eidlerhalf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"eidlerarray", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"nidl", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{"2", "\[Pi]", " ", "c"}], 
                 RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]i", "c"]}], 
               RowBox[{"nidl", "[", 
                RowBox[{"\[Lambda]i", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Epumparray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{"epumphalf", ",", "pts", ",", "dt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Esigarray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{
         RowBox[{"RotateRight", "[", 
          RowBox[{"esighalf", ",", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
            "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eidlerarray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{
         RowBox[{"RotateRight", "[", 
          RowBox[{"eidlerhalf", ",", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
            "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"loop", " ", "nonlinearity"}], ",", " ", "xform", ",", " ", 
        "dispersion", ",", " ", 
        RowBox[{"inverse", " ", "xform"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<", "zpts"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"soln", "=", 
          RowBox[{"nlsolve", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Esigarray", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"Eidlerarray", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"Epumparray", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Esigarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"soln", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Eidlerarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"soln", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Epumparray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"soln", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"epumparray", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"FFT", "[", 
           RowBox[{
            RowBox[{"Epumparray", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"esigarray", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"RotateLeft", "[", 
           RowBox[{
            RowBox[{"FFT", "[", 
             RowBox[{
              RowBox[{"Esigarray", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", 
              "dt"}], "]"}], ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eidlerarray", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"RotateLeft", "[", 
           RowBox[{
            RowBox[{"FFT", "[", 
             RowBox[{
              RowBox[{"Eidlerarray", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", 
              "dt"}], "]"}], ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"epumparray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"epumparray", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"I", "*", "disp", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
                 RowBox[{"npump", "[", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"2", "\[Pi]", " ", "c"}], 
                    RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                   RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                  "]"}]}], 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["\[Omega]p", "c"]}], 
                  RowBox[{"npump", "[", 
                   RowBox[{"\[Lambda]p", ",", 
                    RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                   "]"}]}], "*)"}], "-", 
                RowBox[{"const", "*", 
                 RowBox[{"(", 
                  RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
              "dz"}], "]"}]}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"esigarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"esigarray", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"I", "*", "disp", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
                 RowBox[{"nsig", "[", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"2", "\[Pi]", " ", "c"}], 
                    RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                   RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                  "]"}]}], 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["\[Omega]s", "c"]}], 
                  RowBox[{"npump", "[", 
                   RowBox[{"\[Lambda]p", ",", 
                    RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                   "]"}]}], "*)"}], "-", 
                RowBox[{"const", "*", 
                 RowBox[{"(", 
                  RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
              "dz"}], "]"}]}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eidlerarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"eidlerarray", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"I", "*", "disp", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
                 RowBox[{"nidl", "[", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"2", "\[Pi]", " ", "c"}], 
                    RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                   RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                  "]"}]}], 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["\[Omega]i", "c"]}], 
                  RowBox[{"npump", "[", 
                   RowBox[{"\[Lambda]p", ",", 
                    RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                   "]"}]}], "*)"}], "-", 
                RowBox[{"const", "*", 
                 RowBox[{"(", 
                  RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
              "dz"}], "]"}]}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Epumparray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"InverseFFT", "[", 
           RowBox[{
            RowBox[{"epumparray", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Esigarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"InverseFFT", "[", 
           RowBox[{
            RowBox[{"RotateRight", "[", 
             RowBox[{
              RowBox[{"esigarray", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
               "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Eidlerarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"InverseFFT", "[", 
           RowBox[{
            RowBox[{"RotateRight", "[", 
             RowBox[{
              RowBox[{"eidlerarray", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
               "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ref", " ", "@", " ", 
          RowBox[{"SetPropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
            " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "/", "zpts"}], ")"}], "100"}]}], "]"}]}], ";"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ReleaseGUIObject", "[", "ref", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"full", " ", "step", " ", "dz", " ", "in", " ", "time"}], ",",
         " ", 
        RowBox[{
        "half", " ", "step", " ", "in", " ", "\[Omega]", " ", "to", " ", 
         "complete", " ", "symmetric", " ", "propagation"}]}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"soln", "=", 
       RowBox[{"nlsolve", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Esigarray", "[", 
           RowBox[{"[", "zpts", "]"}], "]"}], ",", 
          RowBox[{"Eidlerarray", "[", 
           RowBox[{"[", "zpts", "]"}], "]"}], ",", 
          RowBox[{"Epumparray", "[", 
           RowBox[{"[", "zpts", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Esigarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"soln", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eidlerarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"soln", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Epumparray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"soln", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"epumparray", "[", 
        RowBox[{"[", "zpts", "]"}], "]"}], "=", 
       RowBox[{"FFT", "[", 
        RowBox[{
         RowBox[{"Epumparray", "[", 
          RowBox[{"[", 
           RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"esigarray", "[", 
        RowBox[{"[", "zpts", "]"}], "]"}], "=", 
       RowBox[{"RotateLeft", "[", 
        RowBox[{
         RowBox[{"FFT", "[", 
          RowBox[{
           RowBox[{"Esigarray", "[", 
            RowBox[{"[", 
             RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", "pts", ",", 
           "dt"}], "]"}], ",", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eidlerarray", "[", 
        RowBox[{"[", "zpts", "]"}], "]"}], "=", 
       RowBox[{"RotateLeft", "[", 
        RowBox[{
         RowBox[{"FFT", "[", 
          RowBox[{
           RowBox[{"Eidlerarray", "[", 
            RowBox[{"[", "zpts", "]"}], "]"}], ",", "pts", ",", "dt"}], "]"}],
          ",", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"epumparray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"epumparray", "[", 
          RowBox[{"[", "zpts", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"npump", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{"2", "\[Pi]", " ", "c"}], 
                 RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]p", "c"]}], 
               RowBox[{"npump", "[", 
                RowBox[{"\[Lambda]p", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"esigarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"esigarray", "[", 
          RowBox[{"[", "zpts", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"nsig", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{"2", "\[Pi]", " ", "c"}], 
                 RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]s", "c"]}], 
               RowBox[{"nsig", "[", 
                RowBox[{"\[Lambda]s", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eidlerarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"eidlerarray", "[", 
          RowBox[{"[", "zpts", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"nidl", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{"2", "\[Pi]", " ", "c"}], 
                 RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]i", "c"]}], 
               RowBox[{"nidl", "[", 
                RowBox[{"\[Lambda]i", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Epumparray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{
         RowBox[{"epumparray", "[", 
          RowBox[{"[", 
           RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Esigarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{
         RowBox[{"RotateRight", "[", 
          RowBox[{
           RowBox[{"esigarray", "[", 
            RowBox[{"[", 
             RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
            "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eidlerarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{
         RowBox[{"RotateRight", "[", 
          RowBox[{
           RowBox[{"eidlerarray", "[", 
            RowBox[{"[", 
             RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
            "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Ecalc", "==", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Energy", " ", "calculations"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ref2", " ", "=", " ", 
          RowBox[{"ProgressDialog", "[", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"idlerE", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{"Eidlerarray", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "2"], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "pts"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"zpts", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ref2", " ", "@", " ", 
          RowBox[{"SetPropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
            " ", "33"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"sigE", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{"Esigarray", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "2"], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "pts"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"zpts", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ref2", " ", "@", " ", 
          RowBox[{"SetPropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
            " ", "66"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pumpE", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{"Epumparray", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "2"], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "pts"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"zpts", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ref2", " ", "@", " ", 
          RowBox[{"SetPropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
            " ", "100"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Etotal", "=", 
          RowBox[{"pumpE", "+", "sigE", "+", "idlerE"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ReleaseGUIObject", "[", "ref2", "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"final", " ", "output", " ", "array"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
        "Epumparray", ",", "Esigarray", ",", "Eidlerarray", ",", "epumparray",
          ",", "esigarray", ",", "eidlerarray", ",", "pumpE", ",", "sigE", 
         ",", "idlerE", ",", "Etotal", ",", "\[Theta]pm", ",", "\[Beta]"}], 
        "}"}], "]"}], ";"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5416908734449997`*^9, 3.541690874027*^9}, {
  3.5424048681140003`*^9, 3.5424048880629997`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Stage 2", "Subtitle",
 CellChangeTimes->{{3.5405707936412*^9, 3.5405707944082003`*^9}}],

Cell["\<\
SplitStep2 uses an input list for the initial signal instead of generating a \
Gaussian envelope. The input signal must have the same number of points as \
pts, and can be complex. The pump field is still Gaussian and specified the \
same way as in SplitStep. The \[Lambda]s input determines where the spectrum \
of the input signal is centered. If using the output of another Splitstep \
code for the signal input, the \[Lambda]s values should match for both \
simulations to get an accurate spectrum. \
\>", "Text",
 CellChangeTimes->{{3.542405045959*^9, 3.542405162599*^9}, {3.542405242551*^9,
   3.542405326021*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SplitStep2", "[", 
    RowBox[{
    "Ep_", ",", "sigarray_", ",", "\[Alpha]_", ",", "tp_", ",", "\[Delta]t_", 
     ",", "\[Lambda]p_", ",", "\[Lambda]s_", ",", "pts_", ",", "zpts_", ",", 
     "dz_", ",", "\[CapitalDelta]\[Theta]_", ",", "deff_", ",", "disp_", ",", 
     "Ecalc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "FFT", ",", "InverseFFT", ",", "no", ",", "ne", ",", "ne1", ",", 
       "\[Beta]", ",", "nlsolve", ",", "dw", ",", "wlist", ",", "tlist", ",", 
       "zlist", ",", "Epump", ",", "Esig", ",", "Eidler", ",", "epumparray", 
       ",", "esigarray", ",", "eidlerarray", ",", "epumphalf", ",", 
       "esighalf", ",", "eidlerhalf", ",", "\[Theta]Tst", ",", "\[Theta]root",
        ",", "\[Theta]pm", ",", "kp", ",", "ks", ",", "ki", ",", 
       "\[CapitalDelta]k", ",", "i", ",", "j", ",", "idlerE", ",", "sigE", 
       ",", "pumpE", ",", "Etotal", ",", "soln", ",", "fOPA", ",", 
       "Epumparray", ",", "Esigarray", ",", "Eidlerarray", ",", "nsig", ",", 
       "nidl", ",", "npump", ",", "\[Theta]", ",", "\[Omega]", ",", 
       "lambda"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ProgressDialog", "[", "]"}], ":=", 
       RowBox[{"GUIRun", "[", " ", "\[IndentingNewLine]", 
        RowBox[{"Widget", "[", 
         RowBox[{"\"\<Frame\>\"", ",", 
          RowBox[{"{", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"WidgetGroup", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Widget", "[", 
                 RowBox[{"\"\<Label\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<text\>\"", "\[Rule]", "\"\<Percent complete:\>\""}], 
                   "}"}], ",", 
                  RowBox[{"Name", "\[Rule]", "\"\<label\>\""}]}], "]"}], ",", 
                RowBox[{"Widget", "[", 
                 RowBox[{"\"\<ProgressBar\>\"", ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"\<minimum\>\"", "\[Rule]", "0"}], ",", 
                    RowBox[{"\"\<maximum\>\"", "\[Rule]", "100"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<preferredSize\>\"", "\[Rule]", "\[IndentingNewLine]",
                     "  ", 
                    RowBox[{"Widget", "[", 
                    RowBox[{"\"\<Dimension\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<width\>\"", "\[Rule]", "300"}], ",", 
                    RowBox[{"\"\<height\>\"", "\[Rule]", "25"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], ",", 
                  RowBox[{"Name", "\[Rule]", "\"\<bar\>\""}]}], "]"}]}], " ", 
               "\[IndentingNewLine]", "  ", "}"}], ",", " ", 
              RowBox[{"WidgetLayout", " ", "\[Rule]", " ", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<Grouping\>\"", "\[Rule]", " ", "Column"}], ",", 
                 " ", "\[IndentingNewLine]", 
                 RowBox[{"\"\<Border\>\"", " ", "\[Rule]", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"15", ",", "15"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"25", ",", "20"}], "}"}]}], "}"}]}]}], "}"}]}]}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<location\>\"", "\[Rule]", 
             RowBox[{"Widget", "[", 
              RowBox[{"\"\<Point\>\"", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<x\>\"", "\[Rule]", "400"}], ",", 
                 RowBox[{"\"\<y\>\"", "\[Rule]", "400"}]}], "}"}]}], "]"}]}], 
            ",", 
            RowBox[{
            "\"\<title\>\"", "\[Rule]", "\"\<Computation Progress\>\""}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"\"\<resizable\>\"", "\[Rule]", "False"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Name", "\[Rule]", "\"\<frame\>\""}]}], "]"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ref", " ", "=", " ", 
       RowBox[{"ProgressDialog", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FFT", "[", 
        RowBox[{"fLst_", ",", "npts_", ",", "dt1_"}], "]"}], ":=", 
       RowBox[{
        SqrtBox[
         FractionBox[
          RowBox[{"npts", " ", 
           SuperscriptBox["dt1", "2"]}], 
          RowBox[{"2", " ", "\[Pi]"}]]], 
        RowBox[{"RotateLeft", "[", 
         RowBox[{
          RowBox[{"Fourier", "[", 
           RowBox[{"RotateRight", "[", 
            RowBox[{"fLst", ",", 
             RowBox[{"npts", "/", "2"}]}], "]"}], "]"}], ",", 
          RowBox[{"npts", "/", "2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"InverseFFT", "[", 
        RowBox[{"FLst_", ",", "npts_", ",", "dt1_"}], "]"}], ":=", 
       RowBox[{
        SqrtBox[
         FractionBox[
          RowBox[{"2", " ", "\[Pi]"}], 
          RowBox[{"npts", " ", 
           SuperscriptBox["dt1", "2"]}]]], 
        RowBox[{"RotateLeft", "[", 
         RowBox[{
          RowBox[{"InverseFourier", "[", 
           RowBox[{"RotateRight", "[", 
            RowBox[{"FLst", ",", 
             RowBox[{"npts", "/", "2"}]}], "]"}], "]"}], ",", 
          RowBox[{"npts", "/", "2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"no", "[", "lambda_", "]"}], "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2.7359", "+", 
         RowBox[{"0.01878", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lambda", "^", "2"}], "-", "0.01822"}], ")"}]}], "-", 
         RowBox[{"0.01471", " ", 
          RowBox[{"lambda", "^", "2"}]}], "+", 
         RowBox[{".0006081", " ", 
          RowBox[{"lambda", "^", "4"}]}], "-", 
         RowBox[{".0000674", " ", 
          RowBox[{"lambda", "^", "6"}]}]}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"ne1", "[", "lambda_", "]"}], "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2.3753", "+", 
         RowBox[{"0.01224", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lambda", "^", "2"}], "-", "0.01667"}], ")"}]}], "-", 
         RowBox[{"0.01627", " ", 
          RowBox[{"lambda", "^", "2"}]}], "+", 
         RowBox[{".0005716", 
          RowBox[{"lambda", "^", "4"}]}], "-", 
         RowBox[{".00006305", 
          RowBox[{"lambda", "^", "6"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ne", "[", 
        RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", " ", 
       RowBox[{"Sqrt", "[", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], 
            SuperscriptBox[
             RowBox[{"no", "[", "\[Lambda]", "]"}], "2"]], "+", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
            SuperscriptBox[
             RowBox[{"ne1", "[", "\[Lambda]", "]"}], "2"]]}], ")"}], 
         RowBox[{"-", "1"}]], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nsig", "[", 
        RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", 
       RowBox[{"no", "[", "\[Lambda]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nidl", "[", 
        RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", 
       RowBox[{"no", "[", "\[Lambda]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"npump", "[", 
        RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", 
       RowBox[{"ne", "[", 
        RowBox[{"\[Lambda]", ",", "\[Theta]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dt", "=", 
       RowBox[{
        FractionBox["\[Lambda]p", 
         RowBox[{"2", "c"}]], "+", ".001"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dw", "=", 
       RowBox[{"2", 
        RowBox[{"\[Pi]", "/", 
         RowBox[{"(", 
          RowBox[{"pts", "*", "dt"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wlist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", " ", "dw"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"-", "pts"}], "/", "2"}], ",", 
           RowBox[{
            RowBox[{"pts", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tlist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", " ", "dt"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"-", "pts"}], "/", "2"}], ",", 
           RowBox[{
            RowBox[{"pts", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zlist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", " ", "dz"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "zpts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Epump", "[", "t_", "]"}], ":=", 
       RowBox[{"Ep", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["t", "2"]}], "/", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"tp", "/", "1.66511"}], ")"}], "2"]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]p", "=", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "c"}], "\[Lambda]p"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Omega]s", "=", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "c"}], "\[Lambda]s"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Omega]i", "=", 
       RowBox[{"\[Omega]p", "-", "\[Omega]s"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]i", "=", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "c"}], "\[Omega]i"]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"phase", "-", 
        RowBox[{"matching", " ", "calculations"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"ArcSin", "[", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"no", "[", "\[Lambda]s", "]"}], "\[Lambda]i"}], 
          RowBox[{
           RowBox[{"no", "[", "\[Lambda]i", "]"}], "\[Lambda]s"}]], 
         RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]Tst", "=", 
       RowBox[{"\[Pi]", "/", "4"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]root", "=", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"npump", "[", 
             RowBox[{"\[Lambda]p", ",", "\[Theta]"}], "]"}], "\[Lambda]p"], 
           "-", 
           FractionBox[
            RowBox[{
             RowBox[{"nsig", "[", 
              RowBox[{"\[Lambda]s", ",", "\[Theta]"}], "]"}], 
             RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "\[Lambda]s"], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"nidl", "[", 
              RowBox[{"\[Lambda]i", ",", "\[Theta]"}], "]"}], 
             RowBox[{"Cos", "[", "\[Beta]", "]"}]}], "\[Lambda]i"]}], 
          "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "\[Theta]Tst"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]pm", "=", 
       RowBox[{"\[Theta]", "/.", "\[InvisibleSpace]", "\[Theta]root"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Phasematch angle: \>\"", ",", 
        RowBox[{"\[Theta]pm", "/", "Degree"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ks", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"2", "\[Pi]", " ", 
          RowBox[{"nsig", "[", 
           RowBox[{"\[Lambda]s", ",", 
            RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], "]"}]}],
          "\[Lambda]s"], 
        RowBox[{"Cos", "[", "\[Alpha]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ki", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"2", "\[Pi]", " ", 
          RowBox[{"nidl", "[", 
           RowBox[{"\[Lambda]i", ",", 
            RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], "]"}]}],
          "\[Lambda]i"], 
        RowBox[{"Cos", "[", "\[Beta]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kp", "=", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", 
         RowBox[{"npump", "[", 
          RowBox[{"\[Lambda]p", ",", 
           RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], "]"}]}], 
        "\[Lambda]p"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]k", "=", 
       RowBox[{"kp", "-", "ks", "-", "ki"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"const", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            FractionBox["\[Omega]", "c"], 
            RowBox[{"npump", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"2", " ", "\[Pi]", " ", "c"}], "\[Omega]"], ",", 
              RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
             "]"}]}], ",", "\[Omega]"}], "]"}], "/.", 
         RowBox[{"\[Omega]", "\[Rule]", " ", "\[Omega]p"}]}], "//", "N"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"RK4", " ", "nonlinearity", " ", "code"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fOPA", "[", "eIn_", "]"}], ":=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"2", "I", " ", "deff", " ", 
            SuperscriptBox["\[Omega]s", "2"]}], 
           RowBox[{"ks", " ", 
            SuperscriptBox["c", "2"]}]], 
          RowBox[{"eIn", "[", 
           RowBox[{"[", "3", "]"}], "]"}], " ", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"eIn", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"2", "I", " ", "deff", " ", 
            SuperscriptBox["\[Omega]i", "2"]}], 
           RowBox[{"ki", " ", 
            SuperscriptBox["c", "2"]}]], 
          RowBox[{"eIn", "[", 
           RowBox[{"[", "3", "]"}], "]"}], " ", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"eIn", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"2", " ", "I", " ", "deff", " ", 
            SuperscriptBox["\[Omega]p", "2"]}], 
           RowBox[{"kp", " ", 
            SuperscriptBox["c", "2"]}]], 
          RowBox[{"eIn", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", 
          RowBox[{"eIn", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nlsolve", "[", "eIn_", "]"}], ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"RK0", ",", "RK1", ",", "RK2", ",", "RK3", ",", "eOut"}], 
          "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RK0", "=", 
           RowBox[{"dz", " ", 
            RowBox[{"fOPA", "[", "eIn", "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"RK1", "=", 
           RowBox[{"dz", " ", 
            RowBox[{"fOPA", "[", 
             RowBox[{"eIn", "+", 
              RowBox[{"RK0", "/", "2"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"RK2", "=", 
           RowBox[{"dz", " ", 
            RowBox[{"fOPA", "[", 
             RowBox[{"eIn", "+", 
              RowBox[{"RK1", "/", "2"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"RK3", "=", 
           RowBox[{"dz", " ", 
            RowBox[{"fOPA", "[", 
             RowBox[{"eIn", "+", "RK2"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eOut", " ", "=", 
           RowBox[{"eIn", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"RK0", "+", 
               RowBox[{"2", " ", "RK1"}], "+", 
               RowBox[{"2", " ", "RK2"}], "+", "RK3"}], ")"}], "/", "6"}]}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "eOut", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "initialize", " ", "ideal", " ", "gaussian", " ", "fields", " ", "to", 
        " ", "start"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Epumparray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", 
         RowBox[{"pts", "+", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Epumparray", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Epump", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "pts"}], "/", "2"}], "+", "i", "-", "1"}], ")"}], 
            "dt"}], "]"}], "//", "N"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Esigarray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Esigarray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"RotateLeft", "[", 
        RowBox[{"sigarray", ",", 
         RowBox[{"Round", "[", 
          RowBox[{"\[Delta]t", "/", "dt"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Eidlerarray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"epumparray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"epumparray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"FFT", "[", 
        RowBox[{
         RowBox[{"Epumparray", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"esigarray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"esigarray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"RotateLeft", "[", 
        RowBox[{
         RowBox[{"FFT", "[", 
          RowBox[{
           RowBox[{"Esigarray", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "pts", ",", "dt"}], "]"}], 
         ",", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eidlerarray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eidlerarray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"RotateLeft", "[", 
        RowBox[{
         RowBox[{"FFT", "[", 
          RowBox[{
           RowBox[{"Eidlerarray", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "pts", ",", "dt"}], "]"}], 
         ",", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"propagate", " ", 
         RowBox[{"dz", "/", "2"}], " ", "for", " ", "symmetric", " ", 
         "split"}], "-", 
        RowBox[{"step", " ", "start"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"epumphalf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"epumparray", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"npump", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{"2", "\[Pi]", " ", "c"}], 
                 RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]p", "c"]}], 
               RowBox[{"npump", "[", 
                RowBox[{"\[Lambda]p", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"esighalf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"esigarray", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"nsig", "[", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"2", "\[Pi]", " ", "c"}], 
                  RowBox[{"wlist", "+", "\[Omega]p"}]], 
                 RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]s", "c"]}], 
               RowBox[{"nsig", "[", 
                RowBox[{"\[Lambda]s", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eidlerhalf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"eidlerarray", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"nidl", "[", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"2", "\[Pi]", " ", "c"}], 
                  RowBox[{"wlist", "+", "\[Omega]p"}]], 
                 RowBox[{"Cos", "[", "\[Beta]", "]"}]}], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]i", "c"]}], 
               RowBox[{"nidl", "[", 
                RowBox[{"\[Lambda]i", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Epumparray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{"epumphalf", ",", "pts", ",", "dt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Esigarray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{
         RowBox[{"RotateRight", "[", 
          RowBox[{"esighalf", ",", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
            "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eidlerarray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{
         RowBox[{"RotateRight", "[", 
          RowBox[{"eidlerhalf", ",", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
            "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"loop", " ", "nonlinearity"}], ",", " ", "xform", ",", " ", 
        "dispersion", ",", " ", 
        RowBox[{"inverse", " ", "xform"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<", "zpts"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"soln", "=", 
          RowBox[{"nlsolve", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Esigarray", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"Eidlerarray", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"Epumparray", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Esigarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"soln", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Eidlerarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"soln", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Epumparray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"soln", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"epumparray", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"FFT", "[", 
           RowBox[{
            RowBox[{"Epumparray", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"esigarray", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"RotateLeft", "[", 
           RowBox[{
            RowBox[{"FFT", "[", 
             RowBox[{
              RowBox[{"Esigarray", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", 
              "dt"}], "]"}], ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eidlerarray", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"RotateLeft", "[", 
           RowBox[{
            RowBox[{"FFT", "[", 
             RowBox[{
              RowBox[{"Eidlerarray", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", 
              "dt"}], "]"}], ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"epumparray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"epumparray", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"I", "*", "disp", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
                 RowBox[{"npump", "[", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"2", "\[Pi]", " ", "c"}], 
                    RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                   RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                  "]"}]}], 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["\[Omega]p", "c"]}], 
                  RowBox[{"npump", "[", 
                   RowBox[{"\[Lambda]p", ",", 
                    RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                   "]"}]}], "*)"}], "-", 
                RowBox[{"const", "*", 
                 RowBox[{"(", 
                  RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
              "dz"}], "]"}]}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"esigarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"esigarray", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"I", "*", "disp", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
                 RowBox[{"nsig", "[", 
                  RowBox[{
                   RowBox[{
                    FractionBox[
                    RowBox[{"2", "\[Pi]", " ", "c"}], 
                    RowBox[{"wlist", "+", "\[Omega]p"}]], 
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
                   RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                  "]"}]}], 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["\[Omega]s", "c"]}], 
                  RowBox[{"npump", "[", 
                   RowBox[{"\[Lambda]p", ",", 
                    RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                   "]"}]}], "*)"}], "-", 
                RowBox[{"const", "*", 
                 RowBox[{"(", 
                  RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
              "dz"}], "]"}]}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eidlerarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"eidlerarray", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"I", "*", "disp", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
                 RowBox[{"nidl", "[", 
                  RowBox[{
                   RowBox[{
                    FractionBox[
                    RowBox[{"2", "\[Pi]", " ", "c"}], 
                    RowBox[{"wlist", "+", "\[Omega]p"}]], 
                    RowBox[{"Cos", "[", "\[Beta]", "]"}]}], ",", 
                   RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                  "]"}]}], 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["\[Omega]i", "c"]}], 
                  RowBox[{"npump", "[", 
                   RowBox[{"\[Lambda]p", ",", 
                    RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                   "]"}]}], "*)"}], "-", 
                RowBox[{"const", "*", 
                 RowBox[{"(", 
                  RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
              "dz"}], "]"}]}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Epumparray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"InverseFFT", "[", 
           RowBox[{
            RowBox[{"epumparray", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Esigarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"InverseFFT", "[", 
           RowBox[{
            RowBox[{"RotateRight", "[", 
             RowBox[{
              RowBox[{"esigarray", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
               "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Eidlerarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"InverseFFT", "[", 
           RowBox[{
            RowBox[{"RotateRight", "[", 
             RowBox[{
              RowBox[{"eidlerarray", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
               "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ref", " ", "@", " ", 
          RowBox[{"SetPropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
            " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "/", "zpts"}], ")"}], "100"}]}], "]"}]}], ";"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ReleaseGUIObject", "[", "ref", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"full", " ", "step", " ", "dz", " ", "in", " ", "time"}], ",",
         " ", 
        RowBox[{
        "half", " ", "step", " ", "in", " ", "\[Omega]", " ", "to", " ", 
         "complete", " ", "symmetric", " ", "propagation"}]}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"soln", "=", 
       RowBox[{"nlsolve", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Esigarray", "[", 
           RowBox[{"[", "zpts", "]"}], "]"}], ",", 
          RowBox[{"Eidlerarray", "[", 
           RowBox[{"[", "zpts", "]"}], "]"}], ",", 
          RowBox[{"Epumparray", "[", 
           RowBox[{"[", "zpts", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Esigarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"soln", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eidlerarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"soln", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Epumparray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"soln", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"epumparray", "[", 
        RowBox[{"[", "zpts", "]"}], "]"}], "=", 
       RowBox[{"FFT", "[", 
        RowBox[{
         RowBox[{"Epumparray", "[", 
          RowBox[{"[", 
           RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"esigarray", "[", 
        RowBox[{"[", "zpts", "]"}], "]"}], "=", 
       RowBox[{"RotateLeft", "[", 
        RowBox[{
         RowBox[{"FFT", "[", 
          RowBox[{
           RowBox[{"Esigarray", "[", 
            RowBox[{"[", 
             RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", "pts", ",", 
           "dt"}], "]"}], ",", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eidlerarray", "[", 
        RowBox[{"[", "zpts", "]"}], "]"}], "=", 
       RowBox[{"RotateLeft", "[", 
        RowBox[{
         RowBox[{"FFT", "[", 
          RowBox[{
           RowBox[{"Eidlerarray", "[", 
            RowBox[{"[", 
             RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", "pts", ",", 
           "dt"}], "]"}], ",", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"epumparray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"epumparray", "[", 
          RowBox[{"[", "zpts", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"npump", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{"2", "\[Pi]", " ", "c"}], 
                 RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]p", "c"]}], 
               RowBox[{"npump", "[", 
                RowBox[{"\[Lambda]p", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"esigarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"esigarray", "[", 
          RowBox[{"[", "zpts", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"nsig", "[", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"2", "\[Pi]", " ", "c"}], 
                  RowBox[{"wlist", "+", "\[Omega]p"}]], 
                 RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]s", "c"]}], 
               RowBox[{"nsig", "[", 
                RowBox[{"\[Lambda]s", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eidlerarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"eidlerarray", "[", 
          RowBox[{"[", "zpts", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"nidl", "[", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"2", "\[Pi]", " ", "c"}], 
                  RowBox[{"wlist", "+", "\[Omega]p"}]], 
                 RowBox[{"Cos", "[", "\[Beta]", "]"}]}], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]i", "c"]}], 
               RowBox[{"nidl", "[", 
                RowBox[{"\[Lambda]i", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Epumparray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{
         RowBox[{"epumparray", "[", 
          RowBox[{"[", 
           RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Esigarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{
         RowBox[{"RotateRight", "[", 
          RowBox[{
           RowBox[{"esigarray", "[", 
            RowBox[{"[", 
             RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
            "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eidlerarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{
         RowBox[{"RotateRight", "[", 
          RowBox[{
           RowBox[{"eidlerarray", "[", 
            RowBox[{"[", 
             RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
            "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Ecalc", "==", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Energy", " ", "calculations"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ref2", " ", "=", " ", 
          RowBox[{"ProgressDialog", "[", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"idlerE", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{"Eidlerarray", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "2"], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "pts"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"zpts", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ref2", " ", "@", " ", 
          RowBox[{"SetPropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
            " ", "33"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"sigE", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{"Esigarray", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "2"], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "pts"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"zpts", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ref2", " ", "@", " ", 
          RowBox[{"SetPropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
            " ", "66"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pumpE", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{"Epumparray", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "2"], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "pts"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"zpts", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ref2", " ", "@", " ", 
          RowBox[{"SetPropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
            " ", "100"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Etotal", "=", 
          RowBox[{"pumpE", "+", "sigE", "+", "idlerE"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ReleaseGUIObject", "[", "ref2", "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"final", " ", "output", " ", "array"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
        "Epumparray", ",", "Esigarray", ",", "Eidlerarray", ",", "epumparray",
          ",", "esigarray", ",", "eidlerarray", ",", "pumpE", ",", "sigE", 
         ",", "idlerE", ",", "Etotal", ",", "\[Theta]pm", ",", "\[Beta]", ",",
          "wlist", ",", "tlist"}], "}"}], "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.5405708185062*^9, {3.5405708547432003`*^9, 3.5405708851632*^9}, {
   3.5405709201772003`*^9, 3.5405709742742*^9}, {3.5405713432672*^9, 
   3.5405713436991997`*^9}, {3.5405713937702*^9, 3.5405713939922*^9}, {
   3.5405717893142*^9, 3.5405717896642*^9}, {3.5405903920678*^9, 
   3.540590398417*^9}, {3.540749299903*^9, 3.540749331834*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Stage 2 \[Theta]", "Subtitle",
 CellChangeTimes->{{3.5405707936412*^9, 3.5405707944082003`*^9}, {
  3.54075006242*^9, 3.54075006294*^9}}],

Cell["\<\
This version uses an input list for the initial signal and uses the specified \
crystal angle \[Theta]pm instead of the ideal one. \
\>", "Text",
 CellChangeTimes->{{3.542405182347*^9, 3.5424052287019997`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SplitStep2\[Theta]", "[", 
    RowBox[{
    "Ep_", ",", "sigarray_", ",", "\[Alpha]_", ",", "tp_", ",", "\[Delta]t_", 
     ",", "\[Lambda]p_", ",", "\[Lambda]s_", ",", "pts_", ",", "zpts_", ",", 
     "dz_", ",", "\[Theta]pm_", ",", "deff_", ",", "disp_", ",", "Ecalc_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "FFT", ",", "InverseFFT", ",", "no", ",", "ne", ",", "ne1", ",", 
       "\[Beta]", ",", "nlsolve", ",", "zlist", ",", "Epump", ",", "Esig", 
       ",", "Eidler", ",", "epumparray", ",", "esigarray", ",", "eidlerarray",
        ",", "epumphalf", ",", "esighalf", ",", "eidlerhalf", ",", 
       "\[Theta]Tst", ",", "\[Theta]root", ",", "\[Theta]i", ",", 
       "\[CapitalDelta]\[Theta]", ",", "kp", ",", "ks", ",", "ki", ",", 
       "\[CapitalDelta]k", ",", "i", ",", "j", ",", "idlerE", ",", "sigE", 
       ",", "pumpE", ",", "Etotal", ",", "soln", ",", "fOPA", ",", 
       "Epumparray", ",", "Esigarray", ",", "Eidlerarray", ",", "nsig", ",", 
       "nidl", ",", "npump", ",", "\[Theta]", ",", "\[Omega]", ",", 
       "lambda"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ProgressDialog", "[", "]"}], ":=", 
       RowBox[{"GUIRun", "[", " ", "\[IndentingNewLine]", 
        RowBox[{"Widget", "[", 
         RowBox[{"\"\<Frame\>\"", ",", 
          RowBox[{"{", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"WidgetGroup", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Widget", "[", 
                 RowBox[{"\"\<Label\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<text\>\"", "\[Rule]", "\"\<Percent complete:\>\""}], 
                   "}"}], ",", 
                  RowBox[{"Name", "\[Rule]", "\"\<label\>\""}]}], "]"}], ",", 
                RowBox[{"Widget", "[", 
                 RowBox[{"\"\<ProgressBar\>\"", ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"\<minimum\>\"", "\[Rule]", "0"}], ",", 
                    RowBox[{"\"\<maximum\>\"", "\[Rule]", "100"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<preferredSize\>\"", "\[Rule]", "\[IndentingNewLine]",
                     "  ", 
                    RowBox[{"Widget", "[", 
                    RowBox[{"\"\<Dimension\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<width\>\"", "\[Rule]", "300"}], ",", 
                    RowBox[{"\"\<height\>\"", "\[Rule]", "25"}]}], "}"}]}], 
                    "]"}]}]}], "}"}], ",", 
                  RowBox[{"Name", "\[Rule]", "\"\<bar\>\""}]}], "]"}]}], " ", 
               "\[IndentingNewLine]", "  ", "}"}], ",", " ", 
              RowBox[{"WidgetLayout", " ", "\[Rule]", " ", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<Grouping\>\"", "\[Rule]", " ", "Column"}], ",", 
                 " ", "\[IndentingNewLine]", 
                 RowBox[{"\"\<Border\>\"", " ", "\[Rule]", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"15", ",", "15"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"25", ",", "20"}], "}"}]}], "}"}]}]}], "}"}]}]}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<location\>\"", "\[Rule]", 
             RowBox[{"Widget", "[", 
              RowBox[{"\"\<Point\>\"", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<x\>\"", "\[Rule]", "400"}], ",", 
                 RowBox[{"\"\<y\>\"", "\[Rule]", "400"}]}], "}"}]}], "]"}]}], 
            ",", 
            RowBox[{
            "\"\<title\>\"", "\[Rule]", "\"\<Computation Progress\>\""}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"\"\<resizable\>\"", "\[Rule]", "False"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Name", "\[Rule]", "\"\<frame\>\""}]}], "]"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ref", " ", "=", " ", 
       RowBox[{"ProgressDialog", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FFT", "[", 
        RowBox[{"fLst_", ",", "npts_", ",", "dt1_"}], "]"}], ":=", 
       RowBox[{
        SqrtBox[
         FractionBox[
          RowBox[{"npts", " ", 
           SuperscriptBox["dt1", "2"]}], 
          RowBox[{"2", " ", "\[Pi]"}]]], 
        RowBox[{"RotateLeft", "[", 
         RowBox[{
          RowBox[{"Fourier", "[", 
           RowBox[{"RotateRight", "[", 
            RowBox[{"fLst", ",", 
             RowBox[{"npts", "/", "2"}]}], "]"}], "]"}], ",", 
          RowBox[{"npts", "/", "2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"InverseFFT", "[", 
        RowBox[{"FLst_", ",", "npts_", ",", "dt1_"}], "]"}], ":=", 
       RowBox[{
        SqrtBox[
         FractionBox[
          RowBox[{"2", " ", "\[Pi]"}], 
          RowBox[{"npts", " ", 
           SuperscriptBox["dt1", "2"]}]]], 
        RowBox[{"RotateLeft", "[", 
         RowBox[{
          RowBox[{"InverseFourier", "[", 
           RowBox[{"RotateRight", "[", 
            RowBox[{"FLst", ",", 
             RowBox[{"npts", "/", "2"}]}], "]"}], "]"}], ",", 
          RowBox[{"npts", "/", "2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"no", "[", "lambda_", "]"}], "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2.7359", "+", 
         RowBox[{"0.01878", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lambda", "^", "2"}], "-", "0.01822"}], ")"}]}], "-", 
         RowBox[{"0.01471", " ", 
          RowBox[{"lambda", "^", "2"}]}], "+", 
         RowBox[{".0006081", " ", 
          RowBox[{"lambda", "^", "4"}]}], "-", 
         RowBox[{".0000674", " ", 
          RowBox[{"lambda", "^", "6"}]}]}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"ne1", "[", "lambda_", "]"}], "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2.3753", "+", 
         RowBox[{"0.01224", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lambda", "^", "2"}], "-", "0.01667"}], ")"}]}], "-", 
         RowBox[{"0.01627", " ", 
          RowBox[{"lambda", "^", "2"}]}], "+", 
         RowBox[{".0005716", 
          RowBox[{"lambda", "^", "4"}]}], "-", 
         RowBox[{".00006305", 
          RowBox[{"lambda", "^", "6"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ne", "[", 
        RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", " ", 
       RowBox[{"Sqrt", "[", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], 
            SuperscriptBox[
             RowBox[{"no", "[", "\[Lambda]", "]"}], "2"]], "+", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
            SuperscriptBox[
             RowBox[{"ne1", "[", "\[Lambda]", "]"}], "2"]]}], ")"}], 
         RowBox[{"-", "1"}]], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nsig", "[", 
        RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", 
       RowBox[{"no", "[", "\[Lambda]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nidl", "[", 
        RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", 
       RowBox[{"no", "[", "\[Lambda]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"npump", "[", 
        RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", 
       RowBox[{"ne", "[", 
        RowBox[{"\[Lambda]", ",", "\[Theta]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dt", "=", 
       RowBox[{
        FractionBox["\[Lambda]p", 
         RowBox[{"2", "c"}]], "+", ".001"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dw", "=", 
       RowBox[{"2", 
        RowBox[{"\[Pi]", "/", 
         RowBox[{"(", 
          RowBox[{"pts", "*", "dt"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wlist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", " ", "dw"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"-", "pts"}], "/", "2"}], ",", 
           RowBox[{
            RowBox[{"pts", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tlist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", " ", "dt"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"-", "pts"}], "/", "2"}], ",", 
           RowBox[{
            RowBox[{"pts", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zlist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", " ", "dz"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "zpts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Epump", "[", "t_", "]"}], ":=", 
       RowBox[{"Ep", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["t", "2"]}], "/", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"tp", "/", "1.66511"}], ")"}], "2"]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]p", "=", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "c"}], "\[Lambda]p"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Omega]s", "=", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "c"}], "\[Lambda]s"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Omega]i", "=", 
       RowBox[{"\[Omega]p", "-", "\[Omega]s"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]i", "=", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "c"}], "\[Omega]i"]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"phase", "-", 
        RowBox[{"matching", " ", "calculations"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"ArcSin", "[", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"no", "[", "\[Lambda]s", "]"}], "\[Lambda]i"}], 
          RowBox[{
           RowBox[{"no", "[", "\[Lambda]i", "]"}], "\[Lambda]s"}]], 
         RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]Tst", "=", 
       RowBox[{"\[Pi]", "/", "4"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]root", "=", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"npump", "[", 
             RowBox[{"\[Lambda]p", ",", "\[Theta]"}], "]"}], "\[Lambda]p"], 
           "-", 
           FractionBox[
            RowBox[{
             RowBox[{"nsig", "[", 
              RowBox[{"\[Lambda]s", ",", "\[Theta]"}], "]"}], 
             RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "\[Lambda]s"], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"nidl", "[", 
              RowBox[{"\[Lambda]i", ",", "\[Theta]"}], "]"}], 
             RowBox[{"Cos", "[", "\[Beta]", "]"}]}], "\[Lambda]i"]}], 
          "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "\[Theta]Tst"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]i", "=", 
       RowBox[{"\[Theta]", "/.", "\[InvisibleSpace]", "\[Theta]root"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]\[Theta]", "=", "0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Phasematch angle: \>\"", ",", 
        RowBox[{"\[Theta]i", "/", "Degree"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ks", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"2", "\[Pi]", " ", 
          RowBox[{"nsig", "[", 
           RowBox[{"\[Lambda]s", ",", 
            RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], "]"}]}],
          "\[Lambda]s"], 
        RowBox[{"Cos", "[", "\[Alpha]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ki", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"2", "\[Pi]", " ", 
          RowBox[{"nidl", "[", 
           RowBox[{"\[Lambda]i", ",", 
            RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], "]"}]}],
          "\[Lambda]i"], 
        RowBox[{"Cos", "[", "\[Beta]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kp", "=", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", 
         RowBox[{"npump", "[", 
          RowBox[{"\[Lambda]p", ",", 
           RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], "]"}]}], 
        "\[Lambda]p"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]k", "=", 
       RowBox[{"kp", "-", "ks", "-", "ki"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"const", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            FractionBox["\[Omega]", "c"], 
            RowBox[{"npump", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"2", " ", "\[Pi]", " ", "c"}], "\[Omega]"], ",", 
              RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
             "]"}]}], ",", "\[Omega]"}], "]"}], "/.", 
         RowBox[{"\[Omega]", "\[Rule]", " ", "\[Omega]p"}]}], "//", "N"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"RK4", " ", "nonlinearity", " ", "code"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fOPA", "[", "eIn_", "]"}], ":=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"2", "I", " ", "deff", " ", 
            SuperscriptBox["\[Omega]s", "2"]}], 
           RowBox[{"ks", " ", 
            SuperscriptBox["c", "2"]}]], 
          RowBox[{"eIn", "[", 
           RowBox[{"[", "3", "]"}], "]"}], " ", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"eIn", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"2", "I", " ", "deff", " ", 
            SuperscriptBox["\[Omega]i", "2"]}], 
           RowBox[{"ki", " ", 
            SuperscriptBox["c", "2"]}]], 
          RowBox[{"eIn", "[", 
           RowBox[{"[", "3", "]"}], "]"}], " ", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"eIn", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"2", " ", "I", " ", "deff", " ", 
            SuperscriptBox["\[Omega]p", "2"]}], 
           RowBox[{"kp", " ", 
            SuperscriptBox["c", "2"]}]], 
          RowBox[{"eIn", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", 
          RowBox[{"eIn", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nlsolve", "[", "eIn_", "]"}], ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"RK0", ",", "RK1", ",", "RK2", ",", "RK3", ",", "eOut"}], 
          "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RK0", "=", 
           RowBox[{"dz", " ", 
            RowBox[{"fOPA", "[", "eIn", "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"RK1", "=", 
           RowBox[{"dz", " ", 
            RowBox[{"fOPA", "[", 
             RowBox[{"eIn", "+", 
              RowBox[{"RK0", "/", "2"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"RK2", "=", 
           RowBox[{"dz", " ", 
            RowBox[{"fOPA", "[", 
             RowBox[{"eIn", "+", 
              RowBox[{"RK1", "/", "2"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"RK3", "=", 
           RowBox[{"dz", " ", 
            RowBox[{"fOPA", "[", 
             RowBox[{"eIn", "+", "RK2"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eOut", " ", "=", 
           RowBox[{"eIn", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"RK0", "+", 
               RowBox[{"2", " ", "RK1"}], "+", 
               RowBox[{"2", " ", "RK2"}], "+", "RK3"}], ")"}], "/", "6"}]}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "eOut", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "initialize", " ", "ideal", " ", "gaussian", " ", "fields", " ", "to", 
        " ", "start"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Epumparray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", 
         RowBox[{"pts", "+", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Epumparray", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Epump", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "pts"}], "/", "2"}], "+", "i", "-", "1"}], ")"}], 
            "dt"}], "]"}], "//", "N"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Esigarray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Esigarray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"RotateLeft", "[", 
        RowBox[{"sigarray", ",", 
         RowBox[{"Round", "[", 
          RowBox[{"\[Delta]t", "/", "dt"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Eidlerarray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"epumparray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"epumparray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"FFT", "[", 
        RowBox[{
         RowBox[{"Epumparray", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"esigarray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"esigarray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"RotateLeft", "[", 
        RowBox[{
         RowBox[{"FFT", "[", 
          RowBox[{
           RowBox[{"Esigarray", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "pts", ",", "dt"}], "]"}], 
         ",", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eidlerarray", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"zpts", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eidlerarray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"RotateLeft", "[", 
        RowBox[{
         RowBox[{"FFT", "[", 
          RowBox[{
           RowBox[{"Eidlerarray", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "pts", ",", "dt"}], "]"}], 
         ",", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"propagate", " ", 
         RowBox[{"dz", "/", "2"}], " ", "for", " ", "symmetric", " ", 
         "split"}], "-", 
        RowBox[{"step", " ", "start"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"epumphalf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"epumparray", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"npump", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{"2", "\[Pi]", " ", "c"}], 
                 RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]p", "c"]}], 
               RowBox[{"npump", "[", 
                RowBox[{"\[Lambda]p", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"esighalf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"esigarray", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"nsig", "[", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"2", "\[Pi]", " ", "c"}], 
                  RowBox[{"wlist", "+", "\[Omega]p"}]], 
                 RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}], 
              RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]s", "c"]}], 
               RowBox[{"nsig", "[", 
                RowBox[{"\[Lambda]s", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eidlerhalf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"eidlerarray", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"nidl", "[", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"2", "\[Pi]", " ", "c"}], 
                  RowBox[{"wlist", "+", "\[Omega]p"}]], 
                 RowBox[{"Cos", "[", "\[Beta]", "]"}]}], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}], 
              RowBox[{"Cos", "[", "\[Beta]", "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]i", "c"]}], 
               RowBox[{"nidl", "[", 
                RowBox[{"\[Lambda]i", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Epumparray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{"epumphalf", ",", "pts", ",", "dt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Esigarray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{
         RowBox[{"RotateRight", "[", 
          RowBox[{"esighalf", ",", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
            "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eidlerarray", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{
         RowBox[{"RotateRight", "[", 
          RowBox[{"eidlerhalf", ",", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
            "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"loop", " ", "nonlinearity"}], ",", " ", "xform", ",", " ", 
        "dispersion", ",", " ", 
        RowBox[{"inverse", " ", "xform"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<", "zpts"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"soln", "=", 
          RowBox[{"nlsolve", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Esigarray", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"Eidlerarray", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"Epumparray", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Esigarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"soln", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Eidlerarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"soln", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Epumparray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"soln", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"epumparray", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"FFT", "[", 
           RowBox[{
            RowBox[{"Epumparray", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"esigarray", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"RotateLeft", "[", 
           RowBox[{
            RowBox[{"FFT", "[", 
             RowBox[{
              RowBox[{"Esigarray", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", 
              "dt"}], "]"}], ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eidlerarray", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"RotateLeft", "[", 
           RowBox[{
            RowBox[{"FFT", "[", 
             RowBox[{
              RowBox[{"Eidlerarray", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", 
              "dt"}], "]"}], ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"epumparray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"epumparray", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"I", "*", "disp", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
                 RowBox[{"npump", "[", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"2", "\[Pi]", " ", "c"}], 
                    RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                   RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                  "]"}]}], 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["\[Omega]p", "c"]}], 
                  RowBox[{"npump", "[", 
                   RowBox[{"\[Lambda]p", ",", 
                    RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                   "]"}]}], "*)"}], "-", 
                RowBox[{"const", "*", 
                 RowBox[{"(", 
                  RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
              "dz"}], "]"}]}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"esigarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"esigarray", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"I", "*", "disp", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
                 RowBox[{"nsig", "[", 
                  RowBox[{
                   RowBox[{
                    FractionBox[
                    RowBox[{"2", "\[Pi]", " ", "c"}], 
                    RowBox[{"wlist", "+", "\[Omega]p"}]], 
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
                   RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                  "]"}], 
                 RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["\[Omega]s", "c"]}], 
                  RowBox[{"npump", "[", 
                   RowBox[{"\[Lambda]p", ",", 
                    RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                   "]"}]}], "*)"}], "-", 
                RowBox[{"const", "*", 
                 RowBox[{"(", 
                  RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
              "dz"}], "]"}]}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eidlerarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"eidlerarray", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"I", "*", "disp", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
                 RowBox[{"nidl", "[", 
                  RowBox[{
                   RowBox[{
                    FractionBox[
                    RowBox[{"2", "\[Pi]", " ", "c"}], 
                    RowBox[{"wlist", "+", "\[Omega]p"}]], 
                    RowBox[{"Cos", "[", "\[Beta]", "]"}]}], ",", 
                   RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                  "]"}], 
                 RowBox[{"Cos", "[", "\[Beta]", "]"}]}], 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["\[Omega]i", "c"]}], 
                  RowBox[{"npump", "[", 
                   RowBox[{"\[Lambda]p", ",", 
                    RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                   "]"}]}], "*)"}], "-", 
                RowBox[{"const", "*", 
                 RowBox[{"(", 
                  RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
              "dz"}], "]"}]}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Epumparray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"InverseFFT", "[", 
           RowBox[{
            RowBox[{"epumparray", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Esigarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"InverseFFT", "[", 
           RowBox[{
            RowBox[{"RotateRight", "[", 
             RowBox[{
              RowBox[{"esigarray", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
               "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Eidlerarray", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"InverseFFT", "[", 
           RowBox[{
            RowBox[{"RotateRight", "[", 
             RowBox[{
              RowBox[{"eidlerarray", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
               "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ref", " ", "@", " ", 
          RowBox[{"SetPropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
            " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "/", "zpts"}], ")"}], "100"}]}], "]"}]}], ";"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ReleaseGUIObject", "[", "ref", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"full", " ", "step", " ", "dz", " ", "in", " ", "time"}], ",",
         " ", 
        RowBox[{
        "half", " ", "step", " ", "in", " ", "\[Omega]", " ", "to", " ", 
         "complete", " ", "symmetric", " ", "propagation"}]}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"soln", "=", 
       RowBox[{"nlsolve", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Esigarray", "[", 
           RowBox[{"[", "zpts", "]"}], "]"}], ",", 
          RowBox[{"Eidlerarray", "[", 
           RowBox[{"[", "zpts", "]"}], "]"}], ",", 
          RowBox[{"Epumparray", "[", 
           RowBox[{"[", "zpts", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Esigarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"soln", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eidlerarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"soln", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Epumparray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"soln", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"epumparray", "[", 
        RowBox[{"[", "zpts", "]"}], "]"}], "=", 
       RowBox[{"FFT", "[", 
        RowBox[{
         RowBox[{"Epumparray", "[", 
          RowBox[{"[", 
           RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"esigarray", "[", 
        RowBox[{"[", "zpts", "]"}], "]"}], "=", 
       RowBox[{"RotateLeft", "[", 
        RowBox[{
         RowBox[{"FFT", "[", 
          RowBox[{
           RowBox[{"Esigarray", "[", 
            RowBox[{"[", 
             RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", "pts", ",", 
           "dt"}], "]"}], ",", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eidlerarray", "[", 
        RowBox[{"[", "zpts", "]"}], "]"}], "=", 
       RowBox[{"RotateLeft", "[", 
        RowBox[{
         RowBox[{"FFT", "[", 
          RowBox[{
           RowBox[{"Eidlerarray", "[", 
            RowBox[{"[", 
             RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", "pts", ",", 
           "dt"}], "]"}], ",", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"epumparray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"epumparray", "[", 
          RowBox[{"[", "zpts", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"npump", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{"2", "\[Pi]", " ", "c"}], 
                 RowBox[{"wlist", "+", "\[Omega]p"}]], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]p", "c"]}], 
               RowBox[{"npump", "[", 
                RowBox[{"\[Lambda]p", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"esigarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"esigarray", "[", 
          RowBox[{"[", "zpts", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"nsig", "[", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"2", "\[Pi]", " ", "c"}], 
                  RowBox[{"wlist", "+", "\[Omega]p"}]], 
                 RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}], 
              RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]s", "c"]}], 
               RowBox[{"nsig", "[", 
                RowBox[{"\[Lambda]s", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eidlerarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"eidlerarray", "[", 
          RowBox[{"[", "zpts", "]"}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "disp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"wlist", "+", "\[Omega]p"}], "c"], 
              RowBox[{"nidl", "[", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"2", "\[Pi]", " ", "c"}], 
                  RowBox[{"wlist", "+", "\[Omega]p"}]], 
                 RowBox[{"Cos", "[", "\[Beta]", "]"}]}], ",", 
                RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
               "]"}], 
              RowBox[{"Cos", "[", "\[Beta]", "]"}]}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["\[Omega]i", "c"]}], 
               RowBox[{"nidl", "[", 
                RowBox[{"\[Lambda]i", ",", 
                 RowBox[{"\[Theta]pm", "+", "\[CapitalDelta]\[Theta]"}]}], 
                "]"}]}], "*)"}], "-", 
             RowBox[{"const", "*", 
              RowBox[{"(", 
               RowBox[{"wlist", "+", "\[Omega]p"}], ")"}]}]}], ")"}], 
           RowBox[{"dz", "/", "2"}]}], "]"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Epumparray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{
         RowBox[{"epumparray", "[", 
          RowBox[{"[", 
           RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", "pts", ",", "dt"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Esigarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{
         RowBox[{"RotateRight", "[", 
          RowBox[{
           RowBox[{"esigarray", "[", 
            RowBox[{"[", 
             RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Omega]p", "-", "\[Omega]s"}], ")"}], "/", "dw"}], 
            "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eidlerarray", "[", 
        RowBox[{"[", 
         RowBox[{"zpts", "+", "1"}], "]"}], "]"}], "=", 
       RowBox[{"InverseFFT", "[", 
        RowBox[{
         RowBox[{"RotateRight", "[", 
          RowBox[{
           RowBox[{"eidlerarray", "[", 
            RowBox[{"[", 
             RowBox[{"zpts", "+", "1"}], "]"}], "]"}], ",", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Omega]p", "-", "\[Omega]i"}], ")"}], "/", "dw"}], 
            "]"}]}], "]"}], ",", "pts", ",", "dt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Ecalc", "==", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Energy", " ", "calculations"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ref2", " ", "=", " ", 
          RowBox[{"ProgressDialog", "[", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"idlerE", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{"Eidlerarray", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "2"], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "pts"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"zpts", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ref2", " ", "@", " ", 
          RowBox[{"SetPropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
            " ", "33"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"sigE", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{"Esigarray", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "2"], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "pts"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"zpts", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ref2", " ", "@", " ", 
          RowBox[{"SetPropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
            " ", "66"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pumpE", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{"Epumparray", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "2"], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "pts"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"zpts", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ref2", " ", "@", " ", 
          RowBox[{"SetPropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<bar\>\"", ",", " ", "\"\<value\>\""}], "}"}], ",", 
            " ", "100"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Etotal", "=", 
          RowBox[{"pumpE", "+", "sigE", "+", "idlerE"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ReleaseGUIObject", "[", "ref2", "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"final", " ", "output", " ", "array"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
        "Epumparray", ",", "Esigarray", ",", "Eidlerarray", ",", "epumparray",
          ",", "esigarray", ",", "eidlerarray", ",", "pumpE", ",", "sigE", 
         ",", "idlerE", ",", "Etotal", ",", "\[Theta]pm", ",", "\[Beta]", ",",
          "wlist", ",", "tlist"}], "}"}], "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.5405708185062*^9, {3.5405708547432003`*^9, 3.5405708851632*^9}, {
   3.5405709201772003`*^9, 3.5405709742742*^9}, {3.5405713432672*^9, 
   3.5405713436991997`*^9}, {3.5405713937702*^9, 3.5405713939922*^9}, {
   3.5405717893142*^9, 3.5405717896642*^9}, {3.5405903920678*^9, 
   3.540590398417*^9}, {3.540749299903*^9, 3.540749331834*^9}, {
   3.540750085533*^9, 3.540750141851*^9}, {3.54076600827*^9, 
   3.540766008395*^9}, {3.5409229988389997`*^9, 3.540923024179*^9}, 
   3.5411033559252977`*^9, 3.5411035325016975`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Chirpgen", "Subtitle",
 CellChangeTimes->{{3.540751172201*^9, 3.5407511734189997`*^9}}],

Cell["\<\
This simply generates a Gaussian envelope in time with an amplitude Es and \
FWHM fw, and applies the second-order phase \"chirp\" to it. Use the right \
value for \"pts\" and \"\[Lambda]p\" to make the grid compatible with a \
Split-Step simulation. \
\>", "Text",
 CellChangeTimes->{{3.542405345571*^9, 3.542405434808*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"chirpgen", "[", 
     RowBox[{
     "fw_", ",", "Es_", ",", "chirp_", ",", "pts_", ",", "\[Lambda]p_"}], 
     "]"}], ":=", "  ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Omega]p", ",", "dt", ",", "dw", ",", "wlist", ",", "FFT", ",", 
        "InverseFFT", ",", "Esig", ",", "Esigarray", ",", "esigarray", ",", 
        "chirpsig", ",", "tchirp"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Omega]p", "=", 
        FractionBox[
         RowBox[{"2", "\[Pi]", " ", "c"}], "\[Lambda]p"]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dt", "=", 
        RowBox[{
         FractionBox["\[Lambda]p", 
          RowBox[{"2", "c"}]], "+", ".001"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dw", "=", 
        RowBox[{"2", 
         RowBox[{"\[Pi]", "/", 
          RowBox[{"(", 
           RowBox[{"pts", "*", "dt"}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"wlist", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", " ", "dw"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"-", "pts"}], "/", "2"}], ",", 
            RowBox[{
             RowBox[{"pts", "/", "2"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]list", "=", 
        FractionBox[
         RowBox[{"2", "\[Pi]", " ", "c"}], 
         RowBox[{"wlist", "+", "\[Omega]p"}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FFT", "[", 
         RowBox[{"fLst_", ",", "npts_", ",", "dt1_"}], "]"}], ":=", 
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{"npts", " ", 
            SuperscriptBox["dt1", "2"]}], 
           RowBox[{"2", " ", "\[Pi]"}]]], 
         RowBox[{"RotateLeft", "[", 
          RowBox[{
           RowBox[{"Fourier", "[", 
            RowBox[{"RotateRight", "[", 
             RowBox[{"fLst", ",", 
              RowBox[{"npts", "/", "2"}]}], "]"}], "]"}], ",", 
           RowBox[{"npts", "/", "2"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"InverseFFT", "[", 
         RowBox[{"FLst_", ",", "npts_", ",", "dt1_"}], "]"}], ":=", 
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{"2", " ", "\[Pi]"}], 
           RowBox[{"npts", " ", 
            SuperscriptBox["dt1", "2"]}]]], 
         RowBox[{"RotateLeft", "[", 
          RowBox[{
           RowBox[{"InverseFourier", "[", 
            RowBox[{"RotateRight", "[", 
             RowBox[{"FLst", ",", 
              RowBox[{"npts", "/", "2"}]}], "]"}], "]"}], ",", 
           RowBox[{"npts", "/", "2"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Esig", "[", "t_", "]"}], ":=", 
        RowBox[{"Es", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["t", "2"]}], "/", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"fw", "/", "1.66511"}], ")"}], "2"]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Esigarray", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "pts"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"pts", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{
          RowBox[{"Esigarray", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"Esig", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "pts"}], "/", "2"}], "+", "i", "-", "1"}], ")"}],
              "dt"}], "]"}], "//", "N"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"esigarray", "=", 
        RowBox[{"FFT", "[", 
         RowBox[{"Esigarray", ",", "pts", ",", "dt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"chirpsig", "=", 
        RowBox[{"esigarray", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "chirp", 
           SuperscriptBox[
            RowBox[{"(", "wlist", ")"}], "2"]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tchirp", "=", 
        RowBox[{"InverseFFT", "[", 
         RowBox[{"chirpsig", ",", "pts", ",", "dt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"tchirp", ",", "chirpsig"}], "}"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.540765654929*^9, 3.5407656553459997`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Unwrap", "Subtitle",
 CellChangeTimes->{{3.541038055528*^9, 3.54103805644*^9}}],

Cell["\<\
Use this to unwrap the phase of a field after taking the argument (Arg) to \
remove the discontinuities in the phase function (from Dr. Durfee). \
\>", "Text",
 CellChangeTimes->{{3.542405472267*^9, 3.5424054843190002`*^9}, {
  3.5424055180360003`*^9, 3.542405560483*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unwrap", "[", 
    RowBox[{"phs_", ",", "npts_", ",", "dir_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "phstmp", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"phstmp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", "npts", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dir", "\[Equal]", 
         RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          SubscriptBox["phstmp", 
           RowBox[{"\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]], 
          "=", 
          SubscriptBox["phs", 
           RowBox[{"\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"shift", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "2"}], ",", 
           RowBox[{"i", "\[LessEqual]", "npts"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  SubscriptBox["phs", 
                   RowBox[{"\[LeftDoubleBracket]", 
                    RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}]], "-", 
                  SubscriptBox["phs", 
                   RowBox[{
                   "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]]}], 
                 "]"}], ">", "2.5"}], ")"}], ",", "\[IndentingNewLine]", 
              RowBox[{"shift", "=", 
               RowBox[{
                RowBox[{"shift", "+", 
                 RowBox[{
                  RowBox[{"Sign", "[", 
                   RowBox[{
                    SubscriptBox["phs", 
                    RowBox[{"\[LeftDoubleBracket]", 
                    RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}]], "-", 
                    SubscriptBox["phs", 
                    RowBox[{
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]]}],
                    "]"}], " ", "2", " ", "\[Pi]"}]}], "//", "N"}]}], ",", 
              "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["phstmp", 
              RowBox[{"\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]],
              "=", 
             RowBox[{
              SubscriptBox["phs", 
               RowBox[{
               "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]], "+", 
              "shift"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"dir", "\[Equal]", 
         RowBox[{"+", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          SubscriptBox["phstmp", 
           RowBox[{"\[LeftDoubleBracket]", "npts", "\[RightDoubleBracket]"}]],
           "=", 
          SubscriptBox["phs", 
           RowBox[{
           "\[LeftDoubleBracket]", "npts", "\[RightDoubleBracket]"}]]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"shift", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", 
            RowBox[{"npts", "-", "1"}]}], ",", 
           RowBox[{"i", "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  SubscriptBox["phs", 
                   RowBox[{"\[LeftDoubleBracket]", 
                    RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]], "-", 
                  SubscriptBox["phs", 
                   RowBox[{
                   "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]]}], 
                 "]"}], ">", "2.5"}], ")"}], ",", "\[IndentingNewLine]", 
              RowBox[{"shift", "=", 
               RowBox[{
                RowBox[{"shift", "+", 
                 RowBox[{
                  RowBox[{"Sign", "[", 
                   RowBox[{
                    SubscriptBox["phs", 
                    RowBox[{"\[LeftDoubleBracket]", 
                    RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]], "-", 
                    SubscriptBox["phs", 
                    RowBox[{
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]]}],
                    "]"}], " ", "2", " ", "\[Pi]"}]}], "//", "N"}]}], ",", 
              "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["phstmp", 
              RowBox[{"\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]],
              "=", 
             RowBox[{
              SubscriptBox["phs", 
               RowBox[{
               "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]], "+", 
              "shift"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"dir", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          SubscriptBox["phstmp", 
           RowBox[{"\[LeftDoubleBracket]", 
            RowBox[{"npts", "/", "2"}], "\[RightDoubleBracket]"}]], "=", 
          SubscriptBox["phs", 
           RowBox[{"\[LeftDoubleBracket]", 
            RowBox[{"npts", "/", "2"}], "\[RightDoubleBracket]"}]]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"shift", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", 
            RowBox[{
             RowBox[{"npts", "/", "2"}], "-", "1"}]}], ",", 
           RowBox[{"i", "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  SubscriptBox["phs", 
                   RowBox[{"\[LeftDoubleBracket]", 
                    RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]], "-", 
                  SubscriptBox["phs", 
                   RowBox[{
                   "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]]}], 
                 "]"}], ">", "2.5"}], ")"}], ",", "\[IndentingNewLine]", 
              RowBox[{"shift", "=", 
               RowBox[{
                RowBox[{"shift", "+", 
                 RowBox[{
                  RowBox[{"Sign", "[", 
                   RowBox[{
                    SubscriptBox["phs", 
                    RowBox[{"\[LeftDoubleBracket]", 
                    RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]], "-", 
                    SubscriptBox["phs", 
                    RowBox[{
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]]}],
                    "]"}], " ", "2", " ", "\[Pi]"}]}], "//", "N"}]}], ",", 
              "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["phstmp", 
              RowBox[{"\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]],
              "=", 
             RowBox[{
              SubscriptBox["phs", 
               RowBox[{
               "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]], "+", 
              "shift"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"shift", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", 
            RowBox[{
             RowBox[{"npts", "/", "2"}], "+", "1"}]}], ",", 
           RowBox[{"i", "\[LessEqual]", "npts"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  SubscriptBox["phs", 
                   RowBox[{"\[LeftDoubleBracket]", 
                    RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}]], "-", 
                  SubscriptBox["phs", 
                   RowBox[{
                   "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]]}], 
                 "]"}], ">", "2.5"}], ")"}], ",", "\[IndentingNewLine]", 
              RowBox[{"shift", "=", 
               RowBox[{
                RowBox[{"shift", "+", 
                 RowBox[{
                  RowBox[{"Sign", "[", 
                   RowBox[{
                    SubscriptBox["phs", 
                    RowBox[{"\[LeftDoubleBracket]", 
                    RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}]], "-", 
                    SubscriptBox["phs", 
                    RowBox[{
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]]}],
                    "]"}], " ", "2", " ", "\[Pi]"}]}], "//", "N"}]}], ",", 
              "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["phstmp", 
              RowBox[{"\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]],
              "=", 
             RowBox[{
              SubscriptBox["phs", 
               RowBox[{
               "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]], "+", 
              "shift"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\n", "    ", 
      RowBox[{"Return", "[", "phstmp", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input"],

Cell["A simple, 2-point symmetric list derivative function ", "Text",
 CellChangeTimes->{{3.542405566005*^9, 3.542405584901*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"listderiv", "[", "list_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "deriv", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"deriv", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "2"}], ",", 
        RowBox[{"i", "<", 
         RowBox[{"Length", "[", "list", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"deriv", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"list", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             FractionBox[
              RowBox[{
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], "-", 
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "2"}], "]"}], "]"}]}], 
              RowBox[{
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}]]}], 
            "}"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "deriv"}]}], "]"}]}], ";"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["sinc2", "Subtitle",
 CellChangeTimes->{{3.5405561984217997`*^9, 3.5405562032734003`*^9}, {
  3.540990090546*^9, 3.5409900916610003`*^9}}],

Cell[TextData[{
 "Calculates the ideal ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["sinc", "2"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " conversion bandwidths for type1 and type2 BBO. For a different crystal, \
input different Sellmeier equations. Input the pump wavelength \[Lambda]p, \
the range of signal wavelengths to plot [\[Lambda]si, \[Lambda]sf] and the \
spacing between points \[Lambda]space, the phase-matched single wavelength \
\[Lambda]spm, the length of the crystal l and the pump/signal angle \[Alpha]. \
The first output is the conversion factor vs signal wavelength, the second is \
vs idler wavelength, and the third is for SHG of the signal. "
}], "Text",
 CellChangeTimes->{{3.54240566516*^9, 3.542405840133*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"type1", "[", 
    RowBox[{
    "\[Lambda]p_", ",", "\[Lambda]si_", ",", "\[Lambda]sf_", ",", 
     "\[Lambda]space_", ",", "\[Lambda]spm_", ",", "l_", ",", "\[Alpha]_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Lambda]2f", ",", "lambda", ",", "pmConvFactor", ",", 
       "\[CapitalDelta]kBBO1", ",", "output", ",", "output2", ",", "noBBO", 
       ",", "neBBO", ",", "noBBO1", ",", "neBBO1", ",", "\[CapitalDelta]kSHG",
        ",", "\[Theta]pmBBO1", ",", "output3", ",", "\[Beta]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"noBBO", "[", "lambda_", "]"}], "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2.7359", "+", 
         RowBox[{"0.01878", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lambda", "^", "2"}], "-", "0.01822"}], ")"}]}], "-", 
         RowBox[{"0.01471", " ", 
          RowBox[{"lambda", "^", "2"}]}], "+", 
         RowBox[{".0006081", " ", 
          RowBox[{"lambda", "^", "4"}]}], "-", 
         RowBox[{".0000674", " ", 
          RowBox[{"lambda", "^", "6"}]}]}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"neBBO", "[", "lambda_", "]"}], "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2.3753", "+", 
         RowBox[{"0.01224", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lambda", "^", "2"}], "-", "0.01667"}], ")"}]}], "-", 
         RowBox[{"0.01627", " ", 
          RowBox[{"lambda", "^", "2"}]}], "+", 
         RowBox[{".0005716", 
          RowBox[{"lambda", "^", "4"}]}], "-", 
         RowBox[{".00006305", 
          RowBox[{"lambda", "^", "6"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"noBBO1", "[", "\[Lambda]_", "]"}], ":=", " ", 
       RowBox[{"noBBO", "[", "\[Lambda]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"neBBO1", "[", 
        RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", " ", 
       RowBox[{"Sqrt", "[", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], 
            SuperscriptBox[
             RowBox[{"noBBO", "[", "\[Lambda]", "]"}], "2"]], "+", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
            SuperscriptBox[
             RowBox[{"neBBO", "[", "\[Lambda]", "]"}], "2"]]}], ")"}], 
         RowBox[{"-", "1"}]], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Lambda]2f", "[", "\[Lambda]1_", "]"}], ":=", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "\[Lambda]p"], "-", 
          FractionBox["1", "\[Lambda]1"]}], ")"}], 
        RowBox[{"-", "1"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pmConvFactor", "[", 
        RowBox[{"\[CapitalDelta]k_", ",", "len_"}], "]"}], ":=", 
       SuperscriptBox[
        RowBox[{"Sinc", "[", 
         RowBox[{"\[CapitalDelta]k", " ", 
          RowBox[{"len", "/", "2"}]}], "]"}], "2"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"ArcSin", "[", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"noBBO1", "[", "\[Lambda]spm", "]"}], 
           RowBox[{"\[Lambda]2f", "[", "\[Lambda]spm", "]"}]}], 
          RowBox[{
           RowBox[{"noBBO1", "[", 
            RowBox[{"\[Lambda]2f", "[", "\[Lambda]spm", "]"}], "]"}], 
           "\[Lambda]spm"}]], 
         RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalDelta]kBBO1", "[", 
        RowBox[{"\[Lambda]1_", ",", "\[Theta]_"}], "]"}], ":=", " ", 
       RowBox[{"2", "\[Pi]", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"noBBO1", "[", "\[Lambda]1", "]"}], 
            RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "\[Lambda]1"], "+", 
          FractionBox[
           RowBox[{
            RowBox[{"noBBO1", "[", 
             RowBox[{"\[Lambda]2f", "[", "\[Lambda]1", "]"}], "]"}], 
            RowBox[{"Cos", "[", "\[Beta]", "]"}]}], 
           RowBox[{"\[Lambda]2f", "[", "\[Lambda]1", "]"}]], "-", 
          FractionBox[
           RowBox[{"neBBO1", "[", 
            RowBox[{"\[Lambda]p", ",", "\[Theta]"}], "]"}], "\[Lambda]p"]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalDelta]kSHG", "[", 
        RowBox[{"\[Lambda]1_", ",", "\[Theta]_"}], "]"}], ":=", " ", 
       RowBox[{"2", "\[Pi]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", 
           FractionBox[
            RowBox[{"noBBO1", "[", "\[Lambda]1", "]"}], "\[Lambda]1"]}], "-", 
          FractionBox[
           RowBox[{"neBBO1", "[", 
            RowBox[{
             RowBox[{"\[Lambda]1", "/", "2"}], ",", "\[Theta]"}], "]"}], 
           RowBox[{"\[Lambda]1", "/", "2"}]]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]pmBBO1", "=", 
       RowBox[{"\[Theta]", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"noBBO1", "[", "\[Lambda]spm", "]"}], 
              RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "\[Lambda]spm"], "+", 
            FractionBox[
             RowBox[{
              RowBox[{"noBBO1", "[", 
               RowBox[{"\[Lambda]2f", "[", "\[Lambda]spm", "]"}], "]"}], 
              RowBox[{"Cos", "[", "\[Beta]", "]"}]}], 
             RowBox[{"\[Lambda]2f", "[", "\[Lambda]spm", "]"}]], "-", 
            FractionBox[
             RowBox[{"neBBO1", "[", 
              RowBox[{"\[Lambda]p", ",", "\[Theta]"}], "]"}], "\[Lambda]p"]}],
            "\[Equal]", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", 
            RowBox[{"20", "Degree"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Lambda]", ",", 
           RowBox[{"pmConvFactor", "[", 
            RowBox[{
             RowBox[{"\[CapitalDelta]kBBO1", "[", 
              RowBox[{"\[Lambda]", ",", "\[Theta]pmBBO1"}], "]"}], ",", "l"}],
             "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\[Lambda]", ",", "\[Lambda]si", ",", "\[Lambda]sf", ",", 
           "\[Lambda]space"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"output2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Lambda]2f", "[", "\[Lambda]", "]"}], ",", 
           RowBox[{"pmConvFactor", "[", 
            RowBox[{
             RowBox[{"\[CapitalDelta]kBBO1", "[", 
              RowBox[{"\[Lambda]", ",", "\[Theta]pmBBO1"}], "]"}], ",", "l"}],
             "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\[Lambda]", ",", "\[Lambda]si", ",", "\[Lambda]sf", ",", 
           "\[Lambda]space"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"output3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Lambda]", ",", 
           RowBox[{"pmConvFactor", "[", 
            RowBox[{
             RowBox[{"\[CapitalDelta]kSHG", "[", 
              RowBox[{"\[Lambda]", ",", "\[Theta]pmBBO1"}], "]"}], ",", "l"}],
             "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\[Lambda]", ",", "\[Lambda]si", ",", "\[Lambda]sf", ",", 
           "\[Lambda]space"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"output", ",", "output2", ",", "output3"}], "}"}]}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"type2", "[", 
    RowBox[{
    "\[Lambda]p_", ",", "\[Lambda]si_", ",", "\[Lambda]sf_", ",", 
     "\[Lambda]space_", ",", "\[Lambda]spm_", ",", "l_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "noBBO", ",", "neBBO", ",", "noBBO1", ",", "neBBO1", ",", "\[Lambda]2f",
        ",", "lambda", ",", "pmConvFactor", ",", "\[CapitalDelta]kBBO2", ",", 
       "\[Theta]pmBBO2", ",", "output", ",", "output2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"noBBO", "[", "lambda_", "]"}], "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2.7359", "+", 
         RowBox[{"0.01878", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lambda", "^", "2"}], "-", "0.01822"}], ")"}]}], "-", 
         RowBox[{"0.01471", " ", 
          RowBox[{"lambda", "^", "2"}]}], "+", 
         RowBox[{".0006081", " ", 
          RowBox[{"lambda", "^", "4"}]}], "-", 
         RowBox[{".0000674", " ", 
          RowBox[{"lambda", "^", "6"}]}]}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"neBBO", "[", "lambda_", "]"}], "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2.3753", "+", 
         RowBox[{"0.01224", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lambda", "^", "2"}], "-", "0.01667"}], ")"}]}], "-", 
         RowBox[{"0.01627", " ", 
          RowBox[{"lambda", "^", "2"}]}], "+", 
         RowBox[{".0005716", 
          RowBox[{"lambda", "^", "4"}]}], "-", 
         RowBox[{".00006305", 
          RowBox[{"lambda", "^", "6"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"noBBO1", "[", "\[Lambda]_", "]"}], ":=", " ", 
       RowBox[{"noBBO", "[", "\[Lambda]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"neBBO1", "[", 
        RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", " ", 
       RowBox[{"Sqrt", "[", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], 
            SuperscriptBox[
             RowBox[{"noBBO", "[", "\[Lambda]", "]"}], "2"]], "+", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
            SuperscriptBox[
             RowBox[{"neBBO", "[", "\[Lambda]", "]"}], "2"]]}], ")"}], 
         RowBox[{"-", "1"}]], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Lambda]2f", "[", "\[Lambda]1_", "]"}], ":=", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "\[Lambda]p"], "-", 
          FractionBox["1", "\[Lambda]1"]}], ")"}], 
        RowBox[{"-", "1"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pmConvFactor", "[", 
        RowBox[{"\[CapitalDelta]k_", ",", "len_"}], "]"}], ":=", 
       SuperscriptBox[
        RowBox[{"Sinc", "[", 
         RowBox[{"\[CapitalDelta]k", " ", 
          RowBox[{"len", "/", "2"}]}], "]"}], "2"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalDelta]kBBO2", "[", 
        RowBox[{"\[Lambda]1_", ",", "\[Theta]_"}], "]"}], ":=", " ", 
       RowBox[{"2", "\[Pi]", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"noBBO1", "[", "\[Lambda]1", "]"}], "\[Lambda]1"], "+", 
          FractionBox[
           RowBox[{"neBBO1", "[", 
            RowBox[{
             RowBox[{"\[Lambda]2f", "[", "\[Lambda]1", "]"}], ",", 
             "\[Theta]"}], "]"}], 
           RowBox[{"\[Lambda]2f", "[", "\[Lambda]1", "]"}]], "-", 
          FractionBox[
           RowBox[{"neBBO1", "[", 
            RowBox[{"\[Lambda]p", ",", "\[Theta]"}], "]"}], "\[Lambda]p"]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]pmBBO2", "=", 
       RowBox[{"\[Theta]", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"noBBO1", "[", "\[Lambda]spm", "]"}], "\[Lambda]spm"], 
            "+", 
            FractionBox[
             RowBox[{"neBBO1", "[", 
              RowBox[{
               RowBox[{"\[Lambda]2f", "[", "\[Lambda]spm", "]"}], ",", 
               "\[Theta]"}], "]"}], 
             RowBox[{"\[Lambda]2f", "[", "\[Lambda]spm", "]"}]], "-", 
            FractionBox[
             RowBox[{"neBBO1", "[", 
              RowBox[{"\[Lambda]p", ",", "\[Theta]"}], "]"}], "\[Lambda]p"]}],
            "\[Equal]", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", 
            RowBox[{"20", "Degree"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Lambda]", ",", 
           RowBox[{"pmConvFactor", "[", 
            RowBox[{
             RowBox[{"\[CapitalDelta]kBBO2", "[", 
              RowBox[{"\[Lambda]", ",", "\[Theta]pmBBO2"}], "]"}], ",", "l"}],
             "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\[Lambda]", ",", "\[Lambda]si", ",", "\[Lambda]sf", ",", 
           "\[Lambda]space"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"output2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Lambda]2f", "[", "\[Lambda]", "]"}], ",", 
           RowBox[{"pmConvFactor", "[", 
            RowBox[{
             RowBox[{"\[CapitalDelta]kBBO2", "[", 
              RowBox[{"\[Lambda]", ",", "\[Theta]pmBBO2"}], "]"}], ",", "l"}],
             "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\[Lambda]", ",", "\[Lambda]si", ",", "\[Lambda]sf", ",", 
           "\[Lambda]space"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"output", ",", "output2"}], "}"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.540914691789*^9, 3.540914736219*^9}, 
   3.540915356843*^9, {3.5409158994049997`*^9, 3.540915899766*^9}, {
   3.540919156222*^9, 3.540919158041*^9}, {3.540919914523*^9, 
   3.540919918174*^9}, 3.540922557442*^9, {3.540924102546*^9, 
   3.540924103808*^9}, {3.540990072988*^9, 3.5409900741429996`*^9}, {
   3.54240561048*^9, 3.542405640283*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evaluate", "Title",
 CellChangeTimes->{{3.5416516196470003`*^9, 3.541651621712*^9}}],

Cell["", "Text"],

Cell[CellGroupData[{

Cell["Unchirped seed \[Theta] tune", "Subtitle",
 CellChangeTimes->{{3.541690009554*^9, 3.5416900177790003`*^9}}],

Cell["\<\
The calculations used for Figure 4.1 in the thesis, using a broadband seed \
tuned at different phase-matching angles. \
\>", "Text",
 CellChangeTimes->{{3.542405867417*^9, 3.54240588129*^9}, {3.542405917826*^9, 
  3.542405941593*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]tune", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"SplitStep\[Theta]", "[", 
         RowBox[{"240", " ", 
          RowBox[{"(*", "Epump", "*)"}], ",", "10", " ", 
          RowBox[{"(*", "Esig", "*)"}], " ", ",", "0", " ", 
          RowBox[{"(*", "Eidler", "*)"}], " ", ",", 
          RowBox[{"0", "Degree"}], " ", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"sig", "/", "pump"}], " ", "angle"}], "*)"}], ",", 
          RowBox[{"100", "fs"}], " ", 
          RowBox[{"(*", "tp", "*)"}], " ", ",", 
          RowBox[{"2", "fs"}], " ", 
          RowBox[{"(*", "ts", "*)"}], " ", ",", 
          RowBox[{"50", "fs"}], 
          RowBox[{"(*", "ti", "*)"}], " ", ",", 
          RowBox[{
           RowBox[{"-", "0"}], "fs"}], " ", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"\[Delta]t", " ", "p"}], "-", "s"}], "*)"}], " ", ",", 
          RowBox[{"1040", "nm"}], " ", 
          RowBox[{"(*", "\[Lambda]p", "*)"}], " ", ",", 
          RowBox[{"2.08", "um"}], " ", 
          RowBox[{"(*", "\[Lambda]s", "*)"}], " ", ",", "2048", " ", 
          RowBox[{"(*", "tpts", "*)"}], ",", "100", " ", 
          RowBox[{"(*", "zpts", "*)"}], "  ", ",", 
          RowBox[{"20", "um"}], " ", 
          RowBox[{"(*", "dz", "*)"}], " ", ",", "\[Theta]in", 
          RowBox[{"(*", "\[CapitalDelta]\[Theta]", "*)"}], ",", 
          RowBox[{"2", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "6"}]]}], 
          RowBox[{"(*", "deff", "*)"}], ",", "1", 
          RowBox[{"(*", "disp", "*)"}], ",", "0"}], 
         RowBox[{"(*", "Ecalc", "*)"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"5", ",", "100"}], "]"}], "]"}], "]"}], "2"], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]in", ",", 
       RowBox[{"21", "Degree"}], ",", 
       RowBox[{"25", "Degree"}], ",", 
       RowBox[{".2", "Degree"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5416908921070004`*^9, 3.541690892814*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417119057858*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417119164308*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417119271108*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417119376898003`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417119483128*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417119589788*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417119696938*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417119804618*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417119912788*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417120018898*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417120124088*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417120229418*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417120334578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417120440088*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417120546387997`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417120652388*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417120757518*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417120862468*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417120967338*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417121073168*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.4405334616395`"}],
  SequenceForm["Phasematch angle: ", 21.4405334616395],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416900541809998`*^9, 3.541690898291*^9, 
  3.54169098909*^9, 3.541693534349*^9, 3.5417118312967997`*^9, 
  3.5417121178318*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]list", "=", 
   FractionBox[
    RowBox[{"2", "\[Pi]", " ", "c"}], 
    RowBox[{"wlist", "+", "\[Omega]p"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]tune\[Lambda]", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]list", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"\[Theta]tune", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"\[Theta]tune", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]tune", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.541690195743*^9, 3.541690196683*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]p", "=", 
   RowBox[{"1040", "nm"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"noBBO", "[", "lambda_", "]"}], "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"2.7359", "+", 
     RowBox[{"0.01878", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lambda", "^", "2"}], "-", "0.01822"}], ")"}]}], "-", 
     RowBox[{"0.01471", " ", 
      RowBox[{"lambda", "^", "2"}]}], "+", 
     RowBox[{".0006081", " ", 
      RowBox[{"lambda", "^", "4"}]}], "-", 
     RowBox[{".0000674", " ", 
      RowBox[{"lambda", "^", "6"}]}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"neBBO", "[", "lambda_", "]"}], "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"2.3753", "+", 
     RowBox[{"0.01224", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lambda", "^", "2"}], "-", "0.01667"}], ")"}]}], "-", 
     RowBox[{"0.01627", " ", 
      RowBox[{"lambda", "^", "2"}]}], "+", 
     RowBox[{".0005716", 
      RowBox[{"lambda", "^", "4"}]}], "-", 
     RowBox[{".00006305", 
      RowBox[{"lambda", "^", "6"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"noBBO1", "[", "\[Lambda]_", "]"}], ":=", " ", 
   RowBox[{"noBBO", "[", "\[Lambda]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"neBBO1", "[", 
    RowBox[{"\[Lambda]_", ",", "\[Theta]_"}], "]"}], ":=", " ", 
   RowBox[{"Sqrt", "[", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], 
        SuperscriptBox[
         RowBox[{"noBBO", "[", "\[Lambda]", "]"}], "2"]], "+", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
        SuperscriptBox[
         RowBox[{"neBBO", "[", "\[Lambda]", "]"}], "2"]]}], ")"}], 
     RowBox[{"-", "1"}]], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]2f", "[", "\[Lambda]1_", "]"}], ":=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Lambda]p"], "-", 
      FractionBox["1", "\[Lambda]1"]}], ")"}], 
    RowBox[{"-", "1"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]kBBO1", "[", 
    RowBox[{"\[Lambda]1_", ",", "\[Theta]_"}], "]"}], ":=", " ", 
   RowBox[{"2", "\[Pi]", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"noBBO1", "[", "\[Lambda]1", "]"}], "\[Lambda]1"], "+", 
      FractionBox[
       RowBox[{"noBBO1", "[", 
        RowBox[{"\[Lambda]2f", "[", "\[Lambda]1", "]"}], "]"}], 
       RowBox[{"\[Lambda]2f", "[", "\[Lambda]1", "]"}]], "-", 
      FractionBox[
       RowBox[{"neBBO1", "[", 
        RowBox[{"\[Lambda]p", ",", "\[Theta]"}], "]"}], "\[Lambda]p"]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pmConvFactor", "[", 
    RowBox[{"\[CapitalDelta]k_", ",", "len_"}], "]"}], ":=", 
   SuperscriptBox[
    RowBox[{"Sinc", "[", 
     RowBox[{"\[CapitalDelta]k", " ", 
      RowBox[{"len", "/", "2"}]}], "]"}], "2"]}], 
  ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"output", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", 
         RowBox[{"pmConvFactor", "[", 
          RowBox[{
           RowBox[{"\[CapitalDelta]kBBO1", "[", 
            RowBox[{"\[Lambda]", ",", "\[Theta]in"}], "]"}], ",", 
           RowBox[{"2", "mm"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", "1.2", ",", "4", ",", ".01"}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]in", ",", 
       RowBox[{"21", "Degree"}], ",", 
       RowBox[{"25", "Degree"}], ",", 
       RowBox[{".2", "Degree"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", 
     RowBox[{
      RowBox[{"Length", "[", "\[Theta]tune\[Lambda]", "]"}], "+", "1"}]}], 
    ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]tune\[Lambda]", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "All", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"\[Theta]tune\[Lambda]", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "All", ",", "2"}], "]"}], "]"}], "/", 
       RowBox[{"Max", "[", 
        RowBox[{"\[Theta]tune\[Lambda]", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "All", ",", "2"}], "]"}], "]"}], "]"}]}]}], 
     ";"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.541690961597*^9, 3.541690962421*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"unchirpedplot", "=", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]tune\[Lambda]", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"output", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Red", ",", "Thick"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", "Thick"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1.2", ",", "4"}], "}"}], ",", "All"}], "}"}]}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]tune\[Lambda]", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.541691904153*^9, 3.541691909223*^9}, {3.541694611866*^9,
   3.541694691163*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Walk-off", "Subtitle",
 CellChangeTimes->{{3.5416912926280003`*^9, 3.5416912935950003`*^9}, 
   3.5416917053129997`*^9}],

Cell["\<\
Calculations for Figure 4.5, using different pump/signal timings to compare \
conversion efficiency\
\>", "Text",
 CellChangeTimes->{{3.542405959001*^9, 3.5424059615220003`*^9}, {
  3.542406013551*^9, 3.542406036907*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"walkoff1", "=", 
   RowBox[{
    RowBox[{"SplitStep", "[", 
     RowBox[{"240", " ", 
      RowBox[{"(*", "Epump", "*)"}], ",", "20", 
      RowBox[{"(*", "Esig", "*)"}], " ", ",", "0", " ", 
      RowBox[{"(*", "Eidler", "*)"}], " ", ",", 
      RowBox[{"0", "Degree"}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"sig", "/", "pump"}], " ", "angle"}], "*)"}], ",", 
      RowBox[{"100", "fs"}], " ", 
      RowBox[{"(*", "tp", "*)"}], " ", ",", 
      RowBox[{"100", "fs"}], " ", 
      RowBox[{"(*", "ts", "*)"}], " ", ",", 
      RowBox[{"200", "fs"}], 
      RowBox[{"(*", "ti", "*)"}], " ", ",", 
      RowBox[{
       RowBox[{"-", "120"}], "fs"}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"\[Delta]t", " ", "p"}], "-", "s"}], "*)"}], " ", ",", 
      RowBox[{"1040", "nm"}], " ", 
      RowBox[{"(*", "\[Lambda]p", "*)"}], " ", ",", 
      RowBox[{"2", "um"}], " ", 
      RowBox[{"(*", "\[Lambda]s", "*)"}], " ", ",", "1024", " ", 
      RowBox[{"(*", "tpts", "*)"}], ",", "150", " ", 
      RowBox[{"(*", "zpts", "*)"}], "  ", ",", 
      RowBox[{"20", "um"}], " ", 
      RowBox[{"(*", "dz", "*)"}], " ", ",", 
      RowBox[{"0", "Degree"}], " ", 
      RowBox[{"(*", "\[CapitalDelta]\[Theta]", "*)"}], ",", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}], 
      RowBox[{"(*", "deff", "*)"}], ",", "1", 
      RowBox[{"(*", "disp", "*)"}], ",", "1"}], 
     RowBox[{"(*", "Ecalc", "*)"}], "]"}], "//", "Quiet"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5416914568599997`*^9, 3.541691457649*^9}, {
  3.541691741494*^9, 3.541691741932*^9}, {3.541692927883*^9, 
  3.541692928032*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.46224495207624`"}],
  SequenceForm["Phasematch angle: ", 21.46224495207624],
  Editable->False]], "Print",
 CellChangeTimes->{3.54169171252*^9, 3.5416917579960003`*^9, 
  3.5416929297980003`*^9, 3.541693754906*^9, 3.5417121504228*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"walkoff2", "=", 
   RowBox[{
    RowBox[{"SplitStep", "[", 
     RowBox[{"240", " ", 
      RowBox[{"(*", "Epump", "*)"}], ",", "20", 
      RowBox[{"(*", "Esig", "*)"}], " ", ",", "0", " ", 
      RowBox[{"(*", "Eidler", "*)"}], " ", ",", 
      RowBox[{"0", "Degree"}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"sig", "/", "pump"}], " ", "angle"}], "*)"}], ",", 
      RowBox[{"100", "fs"}], " ", 
      RowBox[{"(*", "tp", "*)"}], " ", ",", 
      RowBox[{"100", "fs"}], " ", 
      RowBox[{"(*", "ts", "*)"}], " ", ",", 
      RowBox[{"200", "fs"}], 
      RowBox[{"(*", "ti", "*)"}], " ", ",", 
      RowBox[{
       RowBox[{"-", "100"}], "fs"}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"\[Delta]t", " ", "p"}], "-", "s"}], "*)"}], " ", ",", 
      RowBox[{"1040", "nm"}], " ", 
      RowBox[{"(*", "\[Lambda]p", "*)"}], " ", ",", 
      RowBox[{"2", "um"}], " ", 
      RowBox[{"(*", "\[Lambda]s", "*)"}], " ", ",", "1024", " ", 
      RowBox[{"(*", "tpts", "*)"}], ",", "150", " ", 
      RowBox[{"(*", "zpts", "*)"}], "  ", ",", 
      RowBox[{"20", "um"}], " ", 
      RowBox[{"(*", "dz", "*)"}], " ", ",", 
      RowBox[{"0", "Degree"}], " ", 
      RowBox[{"(*", "\[CapitalDelta]\[Theta]", "*)"}], ",", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}], 
      RowBox[{"(*", "deff", "*)"}], ",", "1", 
      RowBox[{"(*", "disp", "*)"}], ",", "1"}], 
     RowBox[{"(*", "Ecalc", "*)"}], "]"}], "//", "Quiet"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.5416914641689997`*^9, {3.5416917438459997`*^9, 3.541691744176*^9}, {
   3.541692931067*^9, 3.541692931179*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.46224495207624`"}],
  SequenceForm["Phasematch angle: ", 21.46224495207624],
  Editable->False]], "Print",
 CellChangeTimes->{3.541691766061*^9, 3.541692976105*^9, 3.541693802297*^9, 
  3.5417121957278*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"walkoff3", "=", 
   RowBox[{
    RowBox[{"SplitStep", "[", 
     RowBox[{"240", " ", 
      RowBox[{"(*", "Epump", "*)"}], ",", "20", 
      RowBox[{"(*", "Esig", "*)"}], " ", ",", "0", " ", 
      RowBox[{"(*", "Eidler", "*)"}], " ", ",", 
      RowBox[{"0", "Degree"}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"sig", "/", "pump"}], " ", "angle"}], "*)"}], ",", 
      RowBox[{"100", "fs"}], " ", 
      RowBox[{"(*", "tp", "*)"}], " ", ",", 
      RowBox[{"100", "fs"}], " ", 
      RowBox[{"(*", "ts", "*)"}], " ", ",", 
      RowBox[{"200", "fs"}], 
      RowBox[{"(*", "ti", "*)"}], " ", ",", 
      RowBox[{
       RowBox[{"-", "70"}], "fs"}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"\[Delta]t", " ", "p"}], "-", "s"}], "*)"}], " ", ",", 
      RowBox[{"1040", "nm"}], " ", 
      RowBox[{"(*", "\[Lambda]p", "*)"}], " ", ",", 
      RowBox[{"2", "um"}], " ", 
      RowBox[{"(*", "\[Lambda]s", "*)"}], " ", ",", "1024", " ", 
      RowBox[{"(*", "tpts", "*)"}], ",", "150", " ", 
      RowBox[{"(*", "zpts", "*)"}], "  ", ",", 
      RowBox[{"20", "um"}], " ", 
      RowBox[{"(*", "dz", "*)"}], " ", ",", 
      RowBox[{"0", "Degree"}], " ", 
      RowBox[{"(*", "\[CapitalDelta]\[Theta]", "*)"}], ",", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}], 
      RowBox[{"(*", "deff", "*)"}], ",", "1", 
      RowBox[{"(*", "disp", "*)"}], ",", "1"}], 
     RowBox[{"(*", "Ecalc", "*)"}], "]"}], "//", "Quiet"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.54169146769*^9, {3.541691746167*^9, 3.5416917465769997`*^9}, {
   3.54169293366*^9, 3.541692933722*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.46224495207624`"}],
  SequenceForm["Phasematch angle: ", 21.46224495207624],
  Editable->False]], "Print",
 CellChangeTimes->{3.541691774368*^9, 3.541693022785*^9, 3.54169384876*^9, 
  3.5417122414728003`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"walkoff4", "=", 
   RowBox[{
    RowBox[{"SplitStep", "[", 
     RowBox[{"240", " ", 
      RowBox[{"(*", "Epump", "*)"}], ",", "20", 
      RowBox[{"(*", "Esig", "*)"}], " ", ",", "0", " ", 
      RowBox[{"(*", "Eidler", "*)"}], " ", ",", 
      RowBox[{"0", "Degree"}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"sig", "/", "pump"}], " ", "angle"}], "*)"}], ",", 
      RowBox[{"100", "fs"}], " ", 
      RowBox[{"(*", "tp", "*)"}], " ", ",", 
      RowBox[{"100", "fs"}], " ", 
      RowBox[{"(*", "ts", "*)"}], " ", ",", 
      RowBox[{"200", "fs"}], 
      RowBox[{"(*", "ti", "*)"}], " ", ",", 
      RowBox[{
       RowBox[{"-", "30"}], "fs"}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"\[Delta]t", " ", "p"}], "-", "s"}], "*)"}], " ", ",", 
      RowBox[{"1040", "nm"}], " ", 
      RowBox[{"(*", "\[Lambda]p", "*)"}], " ", ",", 
      RowBox[{"2", "um"}], " ", 
      RowBox[{"(*", "\[Lambda]s", "*)"}], " ", ",", "1024", " ", 
      RowBox[{"(*", "tpts", "*)"}], ",", "150", 
      RowBox[{"(*", "zpts", "*)"}], "  ", ",", 
      RowBox[{"20", "um"}], " ", 
      RowBox[{"(*", "dz", "*)"}], " ", ",", 
      RowBox[{"0", "Degree"}], " ", 
      RowBox[{"(*", "\[CapitalDelta]\[Theta]", "*)"}], ",", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}], 
      RowBox[{"(*", "deff", "*)"}], ",", "1", 
      RowBox[{"(*", "disp", "*)"}], ",", "1"}], 
     RowBox[{"(*", "Ecalc", "*)"}], "]"}], "//", "Quiet"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.541691470067*^9, {3.5416917485369997`*^9, 3.5416917489049997`*^9}, {
   3.541692937034*^9, 3.541692937135*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.46224495207624`"}],
  SequenceForm["Phasematch angle: ", 21.46224495207624],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416917824960003`*^9, 3.541693069495*^9, 
  3.541693895141*^9, 3.5417122871028*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"walkoff5", "=", 
   RowBox[{
    RowBox[{"SplitStep", "[", 
     RowBox[{"240", " ", 
      RowBox[{"(*", "Epump", "*)"}], ",", "20", 
      RowBox[{"(*", "Esig", "*)"}], " ", ",", "0", " ", 
      RowBox[{"(*", "Eidler", "*)"}], " ", ",", 
      RowBox[{"0", "Degree"}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"sig", "/", "pump"}], " ", "angle"}], "*)"}], ",", 
      RowBox[{"100", "fs"}], " ", 
      RowBox[{"(*", "tp", "*)"}], " ", ",", 
      RowBox[{"100", "fs"}], " ", 
      RowBox[{"(*", "ts", "*)"}], " ", ",", 
      RowBox[{"200", "fs"}], 
      RowBox[{"(*", "ti", "*)"}], " ", ",", 
      RowBox[{"0", "fs"}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"\[Delta]t", " ", "p"}], "-", "s"}], "*)"}], " ", ",", 
      RowBox[{"1040", "nm"}], " ", 
      RowBox[{"(*", "\[Lambda]p", "*)"}], " ", ",", 
      RowBox[{"2", "um"}], " ", 
      RowBox[{"(*", "\[Lambda]s", "*)"}], " ", ",", "1024", " ", 
      RowBox[{"(*", "tpts", "*)"}], ",", "150", " ", 
      RowBox[{"(*", "zpts", "*)"}], "  ", ",", 
      RowBox[{"20", "um"}], " ", 
      RowBox[{"(*", "dz", "*)"}], " ", ",", 
      RowBox[{"0", "Degree"}], " ", 
      RowBox[{"(*", "\[CapitalDelta]\[Theta]", "*)"}], ",", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}], 
      RowBox[{"(*", "deff", "*)"}], ",", "1", 
      RowBox[{"(*", "disp", "*)"}], ",", "1"}], 
     RowBox[{"(*", "Ecalc", "*)"}], "]"}], "//", "Quiet"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.54169147248*^9, {3.541691753545*^9, 3.541691753869*^9}, {
   3.541692939458*^9, 3.541692939547*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "21.46224495207624`"}],
  SequenceForm["Phasematch angle: ", 21.46224495207624],
  Editable->False]], "Print",
 CellChangeTimes->{3.5416917903929996`*^9, 3.541693116001*^9, 
  3.541693942097*^9, 3.5417123327208*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"max", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"Abs", "[", 
     SuperscriptBox[
      RowBox[{"walkoff2", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "2"], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"walkoffpump", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"walkoff1", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "j", ",", "i"}], "]"}], "]"}], "]"}], "2"], 
          "/", 
          RowBox[{"Max", "[", 
           SuperscriptBox[
            RowBox[{"Abs", "[", 
             RowBox[{"walkoff1", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "2"], "]"}]}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"walkoff1", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"walkoff1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"walkoffsig1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"walkoff1", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "j", ",", "i"}], "]"}], "]"}], "]"}], "2"], 
          "/", "max"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"walkoff1", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"walkoff1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"walkoffsig2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"walkoff2", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "j", ",", "i"}], "]"}], "]"}], "]"}], "2"], 
          "/", "max"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"walkoff2", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"walkoff2", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"walkoffsig3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"walkoff3", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "j", ",", "i"}], "]"}], "]"}], "]"}], "2"], 
          "/", "max"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"walkoff3", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"walkoff3", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"walkoffsig4", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"walkoff4", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "j", ",", "i"}], "]"}], "]"}], "]"}], "2"], 
          "/", "max"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"walkoff4", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"walkoff4", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"walkoffsig5", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"walkoff5", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "j", ",", "i"}], "]"}], "]"}], "]"}], "2"], 
          "/", "max"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"walkoff5", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"walkoff5", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.541691551918*^9, 3.541691695841*^9}, 
   3.5416919813389997`*^9, {3.541692298727*^9, 3.5416922989110003`*^9}, {
   3.541692369891*^9, 3.541692378882*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zlist", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{".02", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "150"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e1", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"zlist", ",", 
      RowBox[{
       RowBox[{"walkoff1", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "/", 
       RowBox[{"walkoff1", "[", 
        RowBox[{"[", 
         RowBox[{"10", ",", "1"}], "]"}], "]"}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e2", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"zlist", ",", 
      RowBox[{
       RowBox[{"walkoff2", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "/", 
       RowBox[{"walkoff2", "[", 
        RowBox[{"[", 
         RowBox[{"10", ",", "1"}], "]"}], "]"}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e3", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"zlist", ",", 
      RowBox[{
       RowBox[{"walkoff3", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "/", 
       RowBox[{"walkoff3", "[", 
        RowBox[{"[", 
         RowBox[{"10", ",", "1"}], "]"}], "]"}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e4", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"zlist", ",", 
      RowBox[{
       RowBox[{"walkoff4", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "/", 
       RowBox[{"walkoff4", "[", 
        RowBox[{"[", 
         RowBox[{"10", ",", "1"}], "]"}], "]"}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e5", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"zlist", ",", 
      RowBox[{
       RowBox[{"walkoff5", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "/", 
       RowBox[{"walkoff5", "[", 
        RowBox[{"[", 
         RowBox[{"10", ",", "1"}], "]"}], "]"}]}]}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.541693178157*^9, 3.541693206347*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"walkoffplot", "=", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"walkoffsig1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"walkoffsig2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"walkoffsig3", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"walkoffsig4", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"walkoffsig5", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"walkoffpump", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "200"}], ",", "300"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Red", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Orange", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Green", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Purple", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "Thick"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", " ", "350"}]}], "]"}], ",", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"e1", ",", "e2", ",", "e3", ",", "e4", ",", "e5"}], "}"}], 
         ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Red", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Orange", ",", "Thick"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "[", "Green", "]"}], ",", "Thick"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Purple", ",", "Thick"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<crystal position (\[Mu]m)\>\"", ",", "14"}], "]"}], 
            ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<scaled energy\>\"", ",", "14"}], "]"}]}], "}"}]}], 
         ",", 
         RowBox[{"AxesOrigin", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
         RowBox[{"LabelStyle", "\[Rule]", " ", 
          RowBox[{"Directive", "[", "14", "]"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", " ", "350"}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", 
                RowBox[{"(", 
                 RowBox[{"3", "/", "150"}], ")"}]}], ",", "Dashed"}], "}"}], 
             "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "walkoffsig1", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5416924336879997`*^9, 3.541692538795*^9}, {
  3.541692624974*^9, 3.54169267052*^9}, {3.5416927244709997`*^9, 
  3.541692819674*^9}, {3.5416932330439997`*^9, 3.541693379395*^9}, {
  3.5416934152980003`*^9, 3.541693419972*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Back-conversion ", "Subtitle",
 CellChangeTimes->{{3.5416512808710003`*^9, 3.541651289975*^9}, {
  3.541651398817*^9, 3.541651399244*^9}, {3.541651770733*^9, 
  3.541651770935*^9}, {3.541654627334*^9, 3.5416546284560003`*^9}, {
  3.541655111368*^9, 3.541655113686*^9}}],

Cell["\<\
Calculations from Figure 4.3, showing the effects of back-conversion on pulse \
quality\
\>", "Text",
 CellChangeTimes->{{3.5424060452279997`*^9, 3.542406070131*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"chirpgen", "[", 
   RowBox[{
    RowBox[{"15", "fs"}], 
    RowBox[{"(*", "fwhm", "*)"}], ",", "20", 
    RowBox[{"(*", "Es", "*)"}], ",", 
    RowBox[{"-", "300"}], 
    RowBox[{"(*", 
     RowBox[{"chirp", " ", 
      SuperscriptBox["fs", "2"]}], "*)"}], ",", "1024", 
    RowBox[{"(*", "tpts", "*)"}], ",", 
    RowBox[{"800", "nm"}]}], 
   RowBox[{"(*", "\[Lambda]p", "*)"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5416556716099997`*^9, 3.541655672074*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"backconv", "=", 
   RowBox[{
    RowBox[{"SplitStep", "[", 
     RowBox[{"240", " ", 
      RowBox[{"(*", "Epump", "*)"}], ",", "50", 
      RowBox[{"(*", "Esig", "*)"}], " ", ",", "0", " ", 
      RowBox[{"(*", "Eidler", "*)"}], " ", ",", 
      RowBox[{"0", "Degree"}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"sig", "/", "pump"}], " ", "angle"}], "*)"}], ",", 
      RowBox[{"100", "fs"}], " ", 
      RowBox[{"(*", "tp", "*)"}], " ", ",", 
      RowBox[{"100", "fs"}], " ", 
      RowBox[{"(*", "ts", "*)"}], " ", ",", 
      RowBox[{"200", "fs"}], 
      RowBox[{"(*", "ti", "*)"}], " ", ",", 
      RowBox[{
       RowBox[{"-", "0"}], "fs"}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"\[Delta]t", " ", "p"}], "-", "s"}], "*)"}], " ", ",", 
      RowBox[{"800", "nm"}], " ", 
      RowBox[{"(*", "\[Lambda]p", "*)"}], " ", ",", 
      RowBox[{"1.4", "um"}], " ", 
      RowBox[{"(*", "\[Lambda]s", "*)"}], " ", ",", "1024", " ", 
      RowBox[{"(*", "tpts", "*)"}], ",", "200", " ", 
      RowBox[{"(*", "zpts", "*)"}], "  ", ",", 
      RowBox[{"30", "um"}], " ", 
      RowBox[{"(*", "dz", "*)"}], " ", ",", 
      RowBox[{"0", "Degree"}], " ", 
      RowBox[{"(*", "\[CapitalDelta]\[Theta]", "*)"}], ",", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}], 
      RowBox[{"(*", "deff", "*)"}], ",", "1", 
      RowBox[{"(*", "disp", "*)"}], ",", "0"}], 
     RowBox[{"(*", "Ecalc", "*)"}], "]"}], "//", "Quiet"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.54165145626*^9, 3.541651505495*^9}, {3.541651793223*^9, 
  3.541651816796*^9}, {3.541653580099*^9, 3.541653580337*^9}, {
  3.541653664355*^9, 3.541653664828*^9}, {3.541655135649*^9, 
  3.541655142238*^9}, {3.5416556190360003`*^9, 3.541655619635*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "19.82999507884803`"}],
  SequenceForm["Phasematch angle: ", 19.82999507884803],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.541651306608*^9, {3.541651494551*^9, 3.54165150627*^9}, 3.541651676034*^9,
    3.5416518183120003`*^9, 3.5416535813900003`*^9, 3.541653675973*^9, 
   3.541654676527*^9, {3.541655601191*^9, 3.541655620377*^9}, 
   3.541655717297*^9, 3.541694012542*^9, 3.5417125287548*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"norm\[Lambda]", "=", 
   RowBox[{"Max", "[", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"backconv", "[", 
       RowBox[{"[", "5", "]"}], "]"}], "]"}], "2"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normt", "=", 
   RowBox[{"Max", "[", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"backconv", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "2"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]sbc", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]list", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"backconv", "[", 
             RowBox[{"[", 
              RowBox[{"5", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "norm\[Lambda]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"backconv", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"backconv", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]ibc", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]list", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"backconv", "[", 
             RowBox[{"[", 
              RowBox[{"6", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "norm\[Lambda]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"backconv", "[", 
           RowBox[{"[", 
            RowBox[{"6", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"backconv", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsbc", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"backconv", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "normt"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"backconv", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"backconv", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tibc", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"backconv", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "normt"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"backconv", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"backconv", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tpbc", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"backconv", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "normt"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"backconv", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"backconv", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.541652125891*^9, 3.541652255764*^9}, {3.541652409692*^9,
   3.541652415066*^9}, {3.541652580916*^9, 3.541652618184*^9}, {
  3.5416526554639997`*^9, 3.5416526864230003`*^9}, {3.541652743903*^9, 
  3.541652751091*^9}, {3.541652891926*^9, 3.5416529919630003`*^9}, {
  3.541653285749*^9, 3.541653326842*^9}, {3.5416551513050003`*^9, 
  3.5416552295150003`*^9}, {3.541694809684*^9, 3.54169481002*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"plotbc", "=", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tsbc", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"tibc", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"tpbc", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Green", ",", "Thick"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Red", ",", "Thick"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Blue", ",", "Thick"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "200"}], ",", "200"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", " ", "350"}]}], "]"}], ",", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Lambda]sbc", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"\[Lambda]ibc", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Green", ",", "Thick"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Red", ",", "Thick"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2.3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", " ", "350"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "\[Lambda]sbc", "]"}], ",", "1"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.541652447068*^9, 3.541652491449*^9}, {3.541652545858*^9,
    3.541652563533*^9}, 3.5416526304969997`*^9, {3.5416526984639997`*^9, 
   3.5416527175039997`*^9}, {3.541652804973*^9, 3.541652825111*^9}, 
   3.541652914226*^9, {3.541653015108*^9, 3.541653018542*^9}, {
   3.541653177461*^9, 3.541653207008*^9}, {3.541653246134*^9, 
   3.5416532508190002`*^9}, {3.541653345149*^9, 3.541653349125*^9}, {
   3.541653393323*^9, 3.541653398487*^9}, {3.541653696134*^9, 
   3.54165370717*^9}, {3.541653854975*^9, 3.54165386104*^9}, {
   3.541655233948*^9, 3.541655258059*^9}, {3.541655590052*^9, 
   3.541655592273*^9}, {3.54165574924*^9, 3.54165579334*^9}, {3.5416947726*^9,
    3.541694789844*^9}, {3.541694842756*^9, 3.541694865785*^9}, {
   3.5417200746654*^9, 3.5417200893918*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i$$ = 153, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`i$$], 1, 201, 1}}, Typeset`size$$ = {
    725., {112., 116.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i$98012$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`i$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$98012$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> {
        ListLinePlot[{
          Part[$CellContext`tsbc, $CellContext`i$$], 
          Part[$CellContext`tibc, $CellContext`i$$], 
          Part[$CellContext`tpbc, $CellContext`i$$]}, 
         PlotStyle -> {{Green, Thick}, {Red, Thick}, {Blue, Thick}}, Frame -> 
         True, PlotRange -> {{-200, 200}, {0, 1}}, ImageSize -> 350], 
        ListLinePlot[{
          Part[$CellContext`\[Lambda]sbc, $CellContext`i$$], 
          Part[$CellContext`\[Lambda]ibc, $CellContext`i$$]}, 
         PlotStyle -> {{Green, Thick}, {Red, Thick}}, Frame -> True, 
         PlotRange -> {{1, 2.3}, {0, 1}}, ImageSize -> 350]}, 
      "Specifications" :> {{$CellContext`i$$, 1, 201, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{774., {158., 163.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.5416947904709997`*^9, {3.5416948305959997`*^9, 3.541694866189*^9}, 
   3.5417125565438004`*^9, {3.5417200691274*^9, 3.5417200896258*^9}}]
}, Open  ]],

Cell["", "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["1040nm OPA conversion", "Subtitle",
 CellChangeTimes->{{3.5416512808710003`*^9, 3.541651289975*^9}, {
  3.541651398817*^9, 3.541651399244*^9}, {3.5416546238129997`*^9, 
  3.541654624822*^9}}],

Cell["\<\
Calculations from Figures 4.16 and 4.17, showing the final optimized results \
for the 1040nm-pumped OPA\
\>", "Text",
 CellChangeTimes->{{3.542406082295*^9, 3.542406126833*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t1040OPA", "=", 
   RowBox[{"chirpgen", "[", 
    RowBox[{
     RowBox[{"15", "fs"}], 
     RowBox[{"(*", "fwhm", "*)"}], ",", "20", 
     RowBox[{"(*", "Es", "*)"}], ",", 
     RowBox[{"-", "300"}], 
     RowBox[{"(*", 
      RowBox[{"chirp", " ", 
       SuperscriptBox["fs", "2"]}], "*)"}], ",", "1024", 
     RowBox[{"(*", "tpts", "*)"}], ",", 
     RowBox[{"1040", "nm"}]}], 
    RowBox[{"(*", "\[Lambda]p", "*)"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.541651420583*^9, 3.541651450401*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OPA10401", "=", 
   RowBox[{"SplitStep2\[Theta]", "[", 
    RowBox[{"240", 
     RowBox[{"(*", "Epump", "*)"}], ",", 
     RowBox[{"t1040OPA", "[", 
      RowBox[{"[", "1", "]"}], "]"}], 
     RowBox[{"(*", 
      RowBox[{"sig", " ", "input"}], "*)"}], ",", 
     RowBox[{"2", "Degree"}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"pump", "/", "sig"}], " ", "angle"}], "*)"}], ",", 
     RowBox[{"100", "fs"}], 
     RowBox[{"(*", 
      RowBox[{"pump", " ", "FWHM"}], "*)"}], ",", 
     RowBox[{"96", "fs"}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"pump", "/", "sig"}], " ", "time"}], "*)"}], ",", 
     RowBox[{"1040", "nm"}], 
     RowBox[{"(*", "\[Lambda]p", "*)"}], ",", 
     RowBox[{"2.08", "um"}], 
     RowBox[{"(*", "\[Lambda]s", "*)"}], ",", "1024", 
     RowBox[{"(*", "tpts", "*)"}], ",", "100", 
     RowBox[{"(*", "zpts", "*)"}], ",", 
     RowBox[{"30", "um"}], 
     RowBox[{"(*", "dz", "*)"}], ",", 
     RowBox[{"22.1", "Degree"}], 
     RowBox[{"(*", "d\[Theta]", "*)"}], ",", 
     RowBox[{"2", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], 
     RowBox[{"(*", "deff", "*)"}], ",", "1", ",", "0"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.54165145626*^9, 3.541651505495*^9}, 3.541653979087*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "22.106306616581296`"}],
  SequenceForm["Phasematch angle: ", 22.106306616581296`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.541651306608*^9, {3.541651494551*^9, 3.54165150627*^9}, 3.541651676034*^9,
    3.541654139414*^9, 3.541654660594*^9, 3.541694040034*^9, 
   3.5417125567778*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OPA10402", "=", 
   RowBox[{
    RowBox[{"SplitStep2\[Theta]", "[", 
     RowBox[{"180", 
      RowBox[{"(*", "Epump", "*)"}], ",", 
      RowBox[{"Last", "[", 
       RowBox[{"OPA10401", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], 
      RowBox[{"(*", 
       RowBox[{"sig", " ", "input"}], "*)"}], ",", 
      RowBox[{"2", "Degree"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"pump", "/", "sig"}], " ", "angle"}], "*)"}], ",", 
      RowBox[{"100", "fs"}], 
      RowBox[{"(*", 
       RowBox[{"pump", " ", "FWHM"}], "*)"}], ",", 
      RowBox[{"140", "fs"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"pump", "/", "sig"}], " ", "time"}], "*)"}], ",", 
      RowBox[{"1040", "nm"}], 
      RowBox[{"(*", "\[Lambda]p", "*)"}], ",", 
      RowBox[{"2.08", "um"}], 
      RowBox[{"(*", "\[Lambda]s", "*)"}], ",", "1024", 
      RowBox[{"(*", "tpts", "*)"}], ",", "100", 
      RowBox[{"(*", "zpts", "*)"}], ",", 
      RowBox[{"20", "um"}], 
      RowBox[{"(*", "dz", "*)"}], ",", 
      RowBox[{"22.1", "Degree"}], 
      RowBox[{"(*", "d\[Theta]", "*)"}], ",", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}], 
      RowBox[{"(*", "deff", "*)"}], ",", "1", ",", "0"}], "]"}], "//", 
    "Quiet"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5416514862539997`*^9, 3.541651511558*^9}, {
  3.541653986818*^9, 3.541653988715*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "22.106306616581296`"}],
  SequenceForm["Phasematch angle: ", 22.106306616581296`],
  Editable->False]], "Print",
 CellChangeTimes->{3.541651336744*^9, 3.541651512417*^9, 3.541651681231*^9, 
  3.5416541447860003`*^9, 3.541654665907*^9, 3.541694045148*^9, 
  3.5417125618808002`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"norm\[Lambda]", "=", 
   RowBox[{"Max", "[", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"OPA10401", "[", 
       RowBox[{"[", "5", "]"}], "]"}], "]"}], "2"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normt", "=", 
   RowBox[{"Max", "[", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"OPA10401", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "2"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]s10401", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]list", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"OPA10401", "[", 
             RowBox[{"[", 
              RowBox[{"5", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "norm\[Lambda]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"OPA10401", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"OPA10401", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]i10401", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]list", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"OPA10401", "[", 
             RowBox[{"[", 
              RowBox[{"6", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "norm\[Lambda]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"OPA10401", "[", 
           RowBox[{"[", 
            RowBox[{"6", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"OPA10401", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ts10401", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"OPA10401", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "normt"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"OPA10401", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"OPA10401", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ti10401", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"OPA10401", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "normt"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"OPA10401", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"OPA10401", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tp10401", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"tlist", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"OPA10401", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "2"], "/", 
       RowBox[{"Max", "[", 
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          RowBox[{"OPA10401", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "2"], "]"}]}]}], 
     "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.541653956672*^9, 3.541653969483*^9}, {3.54165400045*^9, 
  3.541654075355*^9}, {3.541654204519*^9, 3.541654204656*^9}, {
  3.541654752962*^9, 3.5416547598450003`*^9}, {3.54169421948*^9, 
  3.541694219598*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"plot1040OPA1", "=", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ts10401", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"ti10401", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "tp10401"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "200"}], ",", "200"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Green", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Red", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", "Thick"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", " ", "350"}]}], "]"}], ",", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Lambda]s10401", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"\[Lambda]i10401", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Green", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Red", ",", "Thick"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1.5", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", " ", "350"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Lambda]s10401", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.541654080631*^9, 3.541654088373*^9}, {3.541654119126*^9,
    3.541654128276*^9}, {3.541694227484*^9, 3.541694361676*^9}, 
   3.5416944439960003`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"norm\[Lambda]", "=", 
   RowBox[{"Max", "[", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"OPA10402", "[", 
       RowBox[{"[", "5", "]"}], "]"}], "]"}], "2"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normt", "=", 
   RowBox[{"Max", "[", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"OPA10402", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "2"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]s10402", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]list", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"OPA10402", "[", 
             RowBox[{"[", 
              RowBox[{"5", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "norm\[Lambda]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"OPA10402", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"OPA10402", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]i10402", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]list", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"OPA10402", "[", 
             RowBox[{"[", 
              RowBox[{"6", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "norm\[Lambda]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"OPA10402", "[", 
           RowBox[{"[", 
            RowBox[{"6", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"OPA10402", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ts10402", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"OPA10402", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "normt"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"OPA10402", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"OPA10402", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ti10402", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"OPA10402", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "normt"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"OPA10402", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"OPA10402", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tp10402", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"OPA10402", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "normt"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"OPA10402", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"OPA10402", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.5416542544049997`*^9, 3.541654300674*^9}, {
  3.54165434908*^9, 3.541654351002*^9}, {3.541654385663*^9, 
  3.5416544038780003`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"plot1040OPA2", "=", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ts10402", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"ti10402", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"tp10402", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "200"}], ",", "200"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Green", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Red", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", "Thick"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", " ", "350"}]}], "]"}], ",", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Lambda]s10402", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"\[Lambda]i10402", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Green", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Red", ",", "Thick"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1.5", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", " ", "350"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Lambda]s10402", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5416543038129997`*^9, 3.5416543219309998`*^9}, {
   3.541654465977*^9, 3.541654467534*^9}, {3.541654523606*^9, 
   3.5416545475769997`*^9}, {3.5416943458450003`*^9, 3.541694346888*^9}, {
   3.541694378152*^9, 3.541694400309*^9}, 3.541694440249*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["1040nm OPA bandwidth", "Subtitle",
 CellChangeTimes->{{3.5416512808710003`*^9, 3.541651289975*^9}, {
  3.541651398817*^9, 3.541651399244*^9}, {3.541651770733*^9, 
  3.541651770935*^9}, {3.541654627334*^9, 3.5416546284560003`*^9}}],

Cell["\<\
Calculations for the wider bandwidth case shown in Figure 4.15\
\>", "Text",
 CellChangeTimes->{{3.542406134139*^9, 3.542406157374*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t1040OPA2", "=", 
   RowBox[{"chirpgen", "[", 
    RowBox[{
     RowBox[{"15", "fs"}], 
     RowBox[{"(*", "fwhm", "*)"}], ",", "20", 
     RowBox[{"(*", "Es", "*)"}], ",", 
     RowBox[{"-", "300"}], 
     RowBox[{"(*", 
      RowBox[{"chirp", " ", 
       SuperscriptBox["fs", "2"]}], "*)"}], ",", "1024", 
     RowBox[{"(*", "tpts", "*)"}], ",", 
     RowBox[{"1040", "nm"}]}], 
    RowBox[{"(*", "\[Lambda]p", "*)"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.541651420583*^9, 3.541651450401*^9}, {3.541651782546*^9,
   3.541651790284*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OPA10403", "=", 
   RowBox[{"SplitStep2\[Theta]", "[", 
    RowBox[{"240", 
     RowBox[{"(*", "Epump", "*)"}], ",", 
     RowBox[{"t1040OPA2", "[", 
      RowBox[{"[", "1", "]"}], "]"}], 
     RowBox[{"(*", 
      RowBox[{"sig", " ", "input"}], "*)"}], ",", 
     RowBox[{"2", "Degree"}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"pump", "/", "sig"}], " ", "angle"}], "*)"}], ",", 
     RowBox[{"100", "fs"}], 
     RowBox[{"(*", 
      RowBox[{"pump", " ", "FWHM"}], "*)"}], ",", 
     RowBox[{"120", "fs"}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"pump", "/", "sig"}], " ", "time"}], "*)"}], ",", 
     RowBox[{"1040", "nm"}], 
     RowBox[{"(*", "\[Lambda]p", "*)"}], ",", 
     RowBox[{"2.08", "um"}], 
     RowBox[{"(*", "\[Lambda]s", "*)"}], ",", "1024", 
     RowBox[{"(*", "tpts", "*)"}], ",", "100", 
     RowBox[{"(*", "zpts", "*)"}], ",", 
     RowBox[{"40", "um"}], 
     RowBox[{"(*", "dz", "*)"}], ",", 
     RowBox[{"22.3", "Degree"}], 
     RowBox[{"(*", "d\[Theta]", "*)"}], ",", 
     RowBox[{"2", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], 
     RowBox[{"(*", "deff", "*)"}], ",", "1", ",", "0"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.54165145626*^9, 3.541651505495*^9}, {3.541651793223*^9, 
  3.541651816796*^9}, {3.541653580099*^9, 3.541653580337*^9}, {
  3.541653664355*^9, 3.541653664828*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phasematch angle: \"\>", "\[InvisibleSpace]", 
   "22.106306616581296`"}],
  SequenceForm["Phasematch angle: ", 22.106306616581296`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.541651306608*^9, {3.541651494551*^9, 3.54165150627*^9}, 3.541651676034*^9,
    3.5416518183120003`*^9, 3.5416535813900003`*^9, 3.541653675973*^9, 
   3.541654676527*^9, 3.541694060389*^9, 3.5417125770298*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"norm\[Lambda]", "=", 
   RowBox[{"Max", "[", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"OPA10403", "[", 
       RowBox[{"[", "6", "]"}], "]"}], "]"}], "2"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normt", "=", 
   RowBox[{"Max", "[", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"OPA10403", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}], "2"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]s10403", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]list", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"OPA10403", "[", 
             RowBox[{"[", 
              RowBox[{"5", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "norm\[Lambda]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"OPA10403", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"OPA10403", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]i10403", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]list", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"OPA10403", "[", 
             RowBox[{"[", 
              RowBox[{"6", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "norm\[Lambda]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"OPA10403", "[", 
           RowBox[{"[", 
            RowBox[{"6", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"OPA10403", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ts10403", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"OPA10403", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "normt"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"OPA10403", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"OPA10403", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ti10403", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"OPA10403", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], "2"], 
          "/", "normt"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"OPA10403", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"OPA10403", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tp10403", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"tlist", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"OPA10403", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "2"], "/", 
       RowBox[{"Max", "[", 
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          RowBox[{"OPA10403", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "2"], "]"}]}]}], 
     "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.541652125891*^9, 3.541652255764*^9}, {3.541652409692*^9,
   3.541652415066*^9}, {3.541652580916*^9, 3.541652618184*^9}, {
  3.5416526554639997`*^9, 3.5416526864230003`*^9}, {3.541652743903*^9, 
  3.541652751091*^9}, {3.541652891926*^9, 3.5416529919630003`*^9}, {
  3.541653285749*^9, 3.541653326842*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"plot1040OPA3", "=", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ts10403", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"ti10403", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "tp10403"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Green", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Red", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", "Thick"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "200"}], ",", "400"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", " ", "350"}]}], "]"}], ",", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Lambda]s10403", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"\[Lambda]i10403", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Green", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Red", ",", "Thick"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1.5", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", " ", "350"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Lambda]s10403", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.541652447068*^9, 3.541652491449*^9}, {3.541652545858*^9,
    3.541652563533*^9}, 3.5416526304969997`*^9, {3.5416526984639997`*^9, 
   3.5416527175039997`*^9}, {3.541652804973*^9, 3.541652825111*^9}, 
   3.541652914226*^9, {3.541653015108*^9, 3.541653018542*^9}, {
   3.541653177461*^9, 3.541653207008*^9}, {3.541653246134*^9, 
   3.5416532508190002`*^9}, {3.541653345149*^9, 3.541653349125*^9}, {
   3.541653393323*^9, 3.541653398487*^9}, {3.541653696134*^9, 
   3.54165370717*^9}, {3.541653854975*^9, 3.54165386104*^9}, {
   3.541694452012*^9, 3.5416945028640003`*^9}, 3.5416945572790003`*^9}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plots", "Title",
 CellChangeTimes->{{3.5416516431940002`*^9, 3.5416516436099997`*^9}, 
   3.542403871948*^9}],

Cell["", "Text"],

Cell[CellGroupData[{

Cell["Unchirped seed \[Theta] tune", "Subtitle",
 CellChangeTimes->{{3.5416900803450003`*^9, 3.541690087644*^9}}],

Cell[CellGroupData[{

Cell[BoxData["unchirpedplot"], "Input",
 CellChangeTimes->{{3.541691916131*^9, 3.541691918467*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i$$ = 12, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`i$$], 1, 21, 1}}, Typeset`size$$ = {
    360., {111., 115.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i$94994$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`i$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$94994$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListLinePlot[{
         Part[$CellContext`\[Theta]tune\[Lambda], $CellContext`i$$], 
         Part[$CellContext`output, $CellContext`i$$]}, 
        PlotStyle -> {{Red, Thick}, {Blue, Thick}}, Frame -> True, 
        PlotRange -> {{1.2, 4}, All}], 
      "Specifications" :> {{$CellContext`i$$, 1, 21, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{409., {157., 162.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.541691224151*^9, 3.541691919512*^9, 3.541694077796*^9, 
  3.54169470074*^9, 3.5417125990178003`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Walk-off", "Subtitle",
 CellChangeTimes->{{3.541691959231*^9, 3.541691962318*^9}}],

Cell[CellGroupData[{

Cell[BoxData["walkoffplot"], "Input",
 CellChangeTimes->{{3.541691963909*^9, 3.541691965389*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i$$ = 151, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`i$$], 1, 151, 1}}, Typeset`size$$ = {
    725., {115., 118.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i$106159$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`i$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$106159$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> {
        ListLinePlot[{
          Part[$CellContext`walkoffsig1, $CellContext`i$$], 
          Part[$CellContext`walkoffsig2, $CellContext`i$$], 
          Part[$CellContext`walkoffsig3, $CellContext`i$$], 
          Part[$CellContext`walkoffsig4, $CellContext`i$$], 
          Part[$CellContext`walkoffsig5, $CellContext`i$$], 
          Part[$CellContext`walkoffpump, $CellContext`i$$]}, 
         PlotRange -> {{-200, 300}, {0, 1}}, Frame -> True, 
         PlotStyle -> {{Red, Thick}, {Orange, Thick}, {Green, Thick}, {
           Blue, Thick}, {Purple, Thick}, {Black, Thick}}, ImageSize -> 350], 
        ListLinePlot[{$CellContext`e1, $CellContext`e2, $CellContext`e3, \
$CellContext`e4, $CellContext`e5}, PlotRange -> All, 
         PlotStyle -> {{Red, Thick}, {Orange, Thick}, {
            Darker[Green], Thick}, {Blue, Thick}, {Purple, Thick}}, 
         FrameLabel -> {
           Style["crystal position (\[Mu]m)", 14], 
           Style["scaled energy", 14]}, AxesOrigin -> {0, 0}, LabelStyle -> 
         Directive[14], Frame -> True, ImageSize -> 350, 
         GridLines -> {{{$CellContext`i$$ (3/150), Dashed}}, {}}]}, 
      "Specifications" :> {{$CellContext`i$$, 1, 151, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{774., {160., 165.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.541693423454*^9, 3.541694095649*^9, 3.541694708443*^9, 
  3.54169502402*^9, 3.541695159236*^9, 3.5417126833978*^9, 3.5417555592508*^9}
  ]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Back-conversion ", "Subtitle",
 CellChangeTimes->{{3.541655815217*^9, 3.541655817649*^9}}],

Cell[CellGroupData[{

Cell[BoxData["plotbc"], "Input"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i$$ = 35, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`i$$], 1, 201, 1}}, Typeset`size$$ = {
    725., {112., 116.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i$98147$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`i$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$98147$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> {
        ListLinePlot[{
          Part[$CellContext`tsbc, $CellContext`i$$], 
          Part[$CellContext`tibc, $CellContext`i$$], 
          Part[$CellContext`tpbc, $CellContext`i$$]}, 
         PlotStyle -> {{Green, Thick}, {Red, Thick}, {Blue, Thick}}, Frame -> 
         True, PlotRange -> {{-200, 200}, {0, 1}}, ImageSize -> 350], 
        ListLinePlot[{
          Part[$CellContext`\[Lambda]sbc, $CellContext`i$$], 
          Part[$CellContext`\[Lambda]ibc, $CellContext`i$$]}, 
         PlotStyle -> {{Green, Thick}, {Red, Thick}}, Frame -> True, 
         PlotRange -> {{1, 2.3}, {0, 1}}, ImageSize -> 350]}, 
      "Specifications" :> {{$CellContext`i$$, 1, 201, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{774., {158., 163.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.54165582266*^9, 3.541694137157*^9, 
  3.5416947182799997`*^9, 3.541694886263*^9, 3.5417126934458*^9, 
  3.5417201004365997`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["1040nm OPA conversion", "Subtitle",
 CellChangeTimes->{{3.5416516527320004`*^9, 3.54165165621*^9}, {
  3.5416537728389997`*^9, 3.541653779381*^9}}],

Cell[CellGroupData[{

Cell[BoxData["plot1040OPA1"], "Input",
 CellChangeTimes->{{3.541654179053*^9, 3.5416541823929996`*^9}, {
  3.54165503392*^9, 3.5416550535039997`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i$$ = 101, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`i$$], 1, 101, 1}}, Typeset`size$$ = {
    725., {110., 114.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i$95366$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`i$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$95366$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> {
        ListLinePlot[{
          Part[$CellContext`ts10401, $CellContext`i$$], 
          Part[$CellContext`ti10401, $CellContext`i$$], $CellContext`tp10401},
          PlotRange -> {{-200, 200}, {0, 1}}, 
         PlotStyle -> {{Green, Thick}, {Red, Thick}, {Blue, Thick}}, Frame -> 
         True, ImageSize -> 350], 
        ListLinePlot[{
          Part[$CellContext`\[Lambda]s10401, $CellContext`i$$], 
          Part[$CellContext`\[Lambda]i10401, $CellContext`i$$]}, 
         PlotStyle -> {{Green, Thick}, {Red, Thick}}, Frame -> True, 
         PlotRange -> {{1.5, 3}, {0, 1}}, ImageSize -> 350]}, 
      "Specifications" :> {{$CellContext`i$$, 1, 101, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{774., {156., 161.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.541654184198*^9, 3.541654212578*^9}, 3.541654599479*^9, 
   3.54165469331*^9, {3.541654770193*^9, 3.541654791757*^9}, {
   3.541655039093*^9, 3.5416550540480003`*^9}, 3.541694152053*^9, 
   3.5416947274820004`*^9, 3.5417127000488*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["plot1040OPA2"], "Input"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i$$ = 101, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`i$$], 1, 101, 1}}, Typeset`size$$ = {
    725., {110., 114.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i$95435$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`i$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$95435$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> {
        ListLinePlot[{
          Part[$CellContext`ts10402, $CellContext`i$$], 
          Part[$CellContext`ti10402, $CellContext`i$$], 
          Part[$CellContext`tp10402, $CellContext`i$$]}, 
         PlotRange -> {{-200, 200}, {0, 1}}, 
         PlotStyle -> {{Green, Thick}, {Red, Thick}, {Blue, Thick}}, Frame -> 
         True, ImageSize -> 350], 
        ListLinePlot[{
          Part[$CellContext`\[Lambda]s10402, $CellContext`i$$], 
          Part[$CellContext`\[Lambda]i10402, $CellContext`i$$]}, 
         PlotStyle -> {{Green, Thick}, {Red, Thick}}, Frame -> True, 
         PlotRange -> {{1.5, 3}, {0, 1}}, ImageSize -> 350]}, 
      "Specifications" :> {{$CellContext`i$$, 1, 101, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{774., {156., 161.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.541654340119*^9, 3.5416544816070004`*^9, {3.541654536803*^9, 
   3.541654551427*^9}, 3.541654708966*^9, 3.5416548087*^9, 3.541694167334*^9, 
   3.541694733433*^9, 3.5417127060698*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["1040nm OPA bandwidth", "Subtitle",
 CellChangeTimes->{{3.5416516527320004`*^9, 3.54165165621*^9}, {
  3.541651833333*^9, 3.541651834726*^9}, {3.541653764533*^9, 
  3.541653771047*^9}}],

Cell[CellGroupData[{

Cell[BoxData["plot1040OPA3"], "Input",
 CellChangeTimes->{{3.541653723869*^9, 3.54165372825*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i$$ = 101, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`i$$], 1, 101, 1}}, Typeset`size$$ = {
    725., {110., 114.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i$95502$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`i$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$95502$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> {
        ListLinePlot[{
          Part[$CellContext`ts10403, $CellContext`i$$], 
          Part[$CellContext`ti10403, $CellContext`i$$], $CellContext`tp10403},
          PlotStyle -> {{Green, Thick}, {Red, Thick}, {Blue, Thick}}, Frame -> 
         True, PlotRange -> {{-200, 400}, {0, 1}}, ImageSize -> 350], 
        ListLinePlot[{
          Part[$CellContext`\[Lambda]s10403, $CellContext`i$$], 
          Part[$CellContext`\[Lambda]i10403, $CellContext`i$$]}, 
         PlotStyle -> {{Green, Thick}, {Red, Thick}}, Frame -> True, 
         PlotRange -> {{1.5, 3}, {0, 1}}, ImageSize -> 350]}, 
      "Specifications" :> {{$CellContext`i$$, 1, 101, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{774., {156., 161.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.5416537213900003`*^9, 3.541653729046*^9}, 
   3.5416538659639997`*^9, 3.541654589719*^9, 3.541654833243*^9, 
   3.541694741389*^9, 3.5417127151028*^9}]
}, Open  ]]
}, Closed]]
}, Closed]]
},
WindowSize->{1208, 663},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 86, 1, 83, "Title"],
Cell[656, 25, 678, 20, 72, "Input"],
Cell[CellGroupData[{
Cell[1359, 49, 137, 2, 49, "Subtitle"],
Cell[1499, 53, 1347, 19, 101, "Text"],
Cell[2849, 74, 61146, 1456, 3665, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[64032, 1535, 99, 1, 49, "Subtitle"],
Cell[64134, 1538, 454, 7, 47, "Text"],
Cell[64591, 1547, 50881, 1287, 3504, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[115509, 2839, 93, 1, 49, "Subtitle"],
Cell[115605, 2842, 630, 10, 65, "Text"],
Cell[116238, 2854, 49961, 1256, 3481, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[166236, 4115, 143, 2, 49, "Subtitle"],
Cell[166382, 4119, 220, 4, 29, "Text"],
Cell[166605, 4125, 50545, 1267, 3521, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[217187, 5397, 93, 1, 49, "Subtitle"],
Cell[217283, 5400, 335, 6, 47, "Text"],
Cell[217621, 5408, 4948, 133, 607, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[222606, 5546, 85, 1, 49, "Subtitle"],
Cell[222694, 5549, 282, 5, 29, "Text"],
Cell[222979, 5556, 10067, 233, 1027, "Input"],
Cell[233049, 5791, 129, 1, 29, "Text"],
Cell[233181, 5794, 1648, 44, 170, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[234866, 5843, 143, 2, 49, "Subtitle"],
Cell[235012, 5847, 754, 14, 65, "Text"],
Cell[235769, 5863, 14361, 361, 860, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[250179, 6230, 90, 1, 83, "Title"],
Cell[250272, 6233, 16, 0, 29, "Text"],
Cell[CellGroupData[{
Cell[250313, 6237, 113, 1, 49, "Subtitle"],
Cell[250429, 6240, 245, 5, 29, "Text"],
Cell[CellGroupData[{
Cell[250699, 6249, 2097, 50, 127, "Input"],
Cell[CellGroupData[{
Cell[252821, 6303, 357, 8, 23, "Print"],
Cell[253181, 6313, 357, 8, 23, "Print"],
Cell[253541, 6323, 357, 8, 23, "Print"],
Cell[253901, 6333, 361, 8, 23, "Print"],
Cell[254265, 6343, 357, 8, 23, "Print"],
Cell[254625, 6353, 357, 8, 23, "Print"],
Cell[254985, 6363, 357, 8, 23, "Print"],
Cell[255345, 6373, 357, 8, 23, "Print"],
Cell[255705, 6383, 357, 8, 23, "Print"],
Cell[256065, 6393, 357, 8, 23, "Print"],
Cell[256425, 6403, 357, 8, 23, "Print"],
Cell[256785, 6413, 357, 8, 23, "Print"],
Cell[257145, 6423, 357, 8, 23, "Print"],
Cell[257505, 6433, 357, 8, 23, "Print"],
Cell[257865, 6443, 361, 8, 23, "Print"],
Cell[258229, 6453, 357, 8, 23, "Print"],
Cell[258589, 6463, 357, 8, 23, "Print"],
Cell[258949, 6473, 357, 8, 23, "Print"],
Cell[259309, 6483, 357, 8, 23, "Print"],
Cell[259669, 6493, 357, 8, 23, "Print"],
Cell[260029, 6503, 357, 8, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[260413, 6515, 987, 28, 70, "Input"],
Cell[261403, 6545, 3106, 90, 257, "Input"],
Cell[264512, 6637, 1585, 46, 72, "Input"],
Cell[266100, 6685, 1156, 32, 52, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[267293, 6722, 126, 2, 49, "Subtitle"],
Cell[267422, 6726, 231, 5, 29, "Text"],
Cell[CellGroupData[{
Cell[267678, 6735, 1698, 42, 76, "Input"],
Cell[269379, 6779, 337, 7, 23, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[269753, 6791, 1683, 42, 76, "Input"],
Cell[271439, 6835, 309, 7, 23, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[271785, 6847, 1675, 42, 76, "Input"],
Cell[273463, 6891, 312, 7, 23, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273812, 6903, 1677, 42, 76, "Input"],
Cell[275492, 6947, 314, 7, 23, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[275843, 6959, 1647, 41, 76, "Input"],
Cell[277493, 7002, 314, 7, 23, "Print"]
}, Open  ]],
Cell[277822, 7012, 6397, 198, 187, "Input"],
Cell[284222, 7212, 2082, 69, 132, "Input"],
Cell[286307, 7283, 4123, 103, 152, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[290467, 7391, 275, 4, 49, "Subtitle"],
Cell[290745, 7397, 176, 4, 29, "Text"],
Cell[290924, 7403, 503, 14, 33, "Input"],
Cell[CellGroupData[{
Cell[291452, 7421, 1819, 43, 76, "Input"],
Cell[293274, 7466, 505, 10, 23, "Print"]
}, Open  ]],
Cell[293794, 7479, 5710, 172, 165, "Input"],
Cell[CellGroupData[{
Cell[299529, 7655, 3134, 75, 112, "Input"],
Cell[302666, 7732, 2207, 44, 338, "Output"]
}, Open  ]],
Cell[304888, 7779, 16, 0, 29, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[304941, 7784, 197, 3, 49, "Subtitle"],
Cell[305141, 7789, 188, 4, 29, "Text"],
Cell[305332, 7795, 541, 15, 33, "Input"],
Cell[CellGroupData[{
Cell[305898, 7814, 1300, 36, 55, "Input"],
Cell[307201, 7852, 397, 9, 23, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[307635, 7866, 1431, 39, 55, "Input"],
Cell[309069, 7907, 381, 8, 23, "Print"]
}, Open  ]],
Cell[309465, 7918, 5160, 158, 165, "Input"],
Cell[314628, 8078, 2542, 65, 112, "Input"],
Cell[317173, 8145, 5461, 169, 165, "Input"],
Cell[322637, 8316, 2711, 68, 112, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[325385, 8389, 236, 3, 49, "Subtitle"],
Cell[325624, 8394, 146, 3, 29, "Text"],
Cell[325773, 8399, 585, 16, 33, "Input"],
Cell[CellGroupData[{
Cell[326383, 8419, 1409, 38, 55, "Input"],
Cell[327795, 8459, 445, 9, 23, "Print"]
}, Open  ]],
Cell[328255, 8471, 5255, 159, 165, "Input"],
Cell[333513, 8632, 2987, 71, 112, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[336549, 8709, 115, 2, 83, "Title"],
Cell[336667, 8713, 16, 0, 29, "Text"],
Cell[CellGroupData[{
Cell[336708, 8717, 113, 1, 49, "Subtitle"],
Cell[CellGroupData[{
Cell[336846, 8722, 99, 1, 31, "Input"],
Cell[336948, 8725, 1794, 36, 336, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[338791, 8767, 88, 1, 49, "Subtitle"],
Cell[CellGroupData[{
Cell[338904, 8772, 97, 1, 31, "Input"],
Cell[339004, 8775, 2727, 52, 342, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[341780, 8833, 96, 1, 49, "Subtitle"],
Cell[CellGroupData[{
Cell[341901, 8838, 32, 0, 31, "Input"],
Cell[341936, 8840, 2194, 44, 338, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[344179, 8890, 153, 2, 49, "Subtitle"],
Cell[CellGroupData[{
Cell[344357, 8896, 150, 2, 31, "Input"],
Cell[344510, 8900, 2292, 45, 334, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[346839, 8950, 38, 0, 31, "Input"],
Cell[346880, 8952, 2278, 46, 334, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[349207, 9004, 190, 3, 49, "Subtitle"],
Cell[CellGroupData[{
Cell[349422, 9011, 97, 1, 31, "Input"],
Cell[349522, 9014, 2199, 43, 334, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}
]
*)

(* End of internal cache information *)
